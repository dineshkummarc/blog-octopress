<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Adventures in JavaScript Development]]></title>
  <link href="http://rmurphey.com/atom.xml" rel="self"/>
  <link href="http://rmurphey.com/"/>
  <updated>2012-03-11T23:17:59-04:00</updated>
  <id>http://rmurphey.com/</id>
  <author>
    <name><![CDATA[Rebecca Murphey]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Thoughts on a (very) small project with Backbone and Backbone Boilerplate]]></title>
    <link href="http://rmurphey.com/blog/2012/03/11/thoughts-on-a-very-small-project-with-backbone-and-backbone-boilerplate/"/>
    <updated>2012-03-11T21:30:00-04:00</updated>
    <id>http://rmurphey.com/blog/2012/03/11/thoughts-on-a-very-small-project-with-backbone-and-backbone-boilerplate</id>
    <content type="html"><![CDATA[<p>I worked with <a href="http://documentcloud.github.com/backbone/">Backbone</a> and the
<a href="https://github.com/tbranyen/backbone-boilerplate">Backbone Boilerplate</a> for
the first time last weekend, putting together a small <a href="https://github.com/rmurphey/bvjs">demo app</a> for a presentation I gave last week at
BazaarVoice. I realize I&#8217;m about 18 months late to the Backbone party, here,
but I wanted to write down my thoughts, mostly because I&#8217;m pretty sure they&#8217;ll
change as I get a chance to work with both tools more.</p>

<h2>Backbone</h2>

<p>Backbone describes itself as a tool that &#8220;gives structure to web applications,&#8221;
but, at the risk of sounding pedantic, I think it would be more accurate to say
that it gives you tools that can help you structure your applications. There&#8217;s
incredibly little prescription about how to use the tools that Backbone
provides, and I have a feeling that the code I wrote to build my simple app
looks a lot different than what someone else might come up with.</p>

<p>This lack of prescription feels good and bad &#8211; good, because I was able to use
Backbone to pretty quickly set up an infrastructure that mirrored ones I&#8217;ve
built in the past; bad, because it leaves open the possibility of lots of
people inventing lots of wheels. To its credit, it packs a lot of power in a
very small package &#8211; 5.3k in production &#8211; but a real app is going to require
layering a lot more functionality on top of it. Ultimately, the best way to
think of Backbone is as the client-side app boilerplate you&#8217;d otherwise have to
write yourself.</p>

<p>My biggest complaint about Backbone is probably how unopinionated it is about
the view layer. Its focus seems to be entirely on the data layer, but the view
is still where we spend the vast majority of our time. Specifically, I think
Backbone could take a page from Dojo, and embrace the concept of &#8220;templated
widgets&#8221;, because that&#8217;s what people seem to be doing with Backbone views
anyway: mixing data with a template to create a DOM fragment, placing that
fragment on the page, listening for user interaction with the fragment, and
updating it as required. Backbone provides for some of this, specifically the
event stuff, but it leaves you to write your own functionality when it comes to
templating, placing, and updating. I think this is a solveable problem without
a whole lot of code, and want to spend some time trying to prove it, but I know
I need to look into the Backbone Layout Manager before I get too carried away.</p>

<h2>Backbone Boilerplate</h2>

<p>This project from Tim Branyen was a life-saver &#8211; it gave me an absolutely
enormous head start when it came to incorporating
<a href="http://requirejs.org/">RequireJS</a>, setting up my application directories, and
setting up a development server. It also included some great inline docs that
helped me get my bearings with Backbone.</p>

<p>There are a couple of ways I think the boilerplate could be improved, and I&#8217;d be
curious for others&#8217; opinions:</p>

<ul>
<li>The sample app includes the concept of &#8220;modules,&#8221; which seem to be a single
file that include the models, collections, views, and routes for a &#8230;
module. I don&#8217;t love the idea of combining all of this into a single file,
because it seems to discourage smart reuse and unit testing of each piece of
functionality. In the app I created, I abandoned the concept of modules, and
instead broke my app into &#8220;components&#8221;, &#8220;controllers&#8221;, and &#8220;services&#8221;. I
explain this breakdown in a bit more depth in the <a href="http://www.slideshare.net/rmurphey/bvjs">presentation I gave at
BazaarVoice</a>. I&#8217;m not sure this is
the right answer for all apps, but I think modules oversimplify things.</li>
<li>The boilerplate includes a <code>namespace.js</code> file. It defines a namespace
object, and that object includes a <code>fetchTemplate</code> method. It seems this
method should only be used by views, and so I&#8217;d rather see something along
the lines of an enhanced View that provides this functionality. That&#8217;s what I
did with the <a href="https://github.com/rmurphey/bvjs/blob/master/app/components/base.js">base component module</a>
in my sample app.</li>
<li>I&#8217;m super-glad to see Jasmine included in the test directory, but
unfortunately the examples show how to write Jasmine tests, not Jasmine tests
for a Backbone app. As a community, we definitely need to be showing more
examples of how to test things, and this seems like a good opportunity to
distribute that knowledge.</li>
</ul>


<h2>Overall</h2>

<p>I feel a little silly that I&#8217;m just now getting around to spending any time
with Backbone, and I know that I only scratched the surface, but I like what I
saw. I think it&#8217;s important to take it for what it is: an uber-tiny library
that gets you pointed in the right direction. What I really want to see are
fuller-fledged frameworks that build on top of Backbone, because I think
there&#8217;s a lot more that can be standardized beyond what Backbone offers. I&#8217;m
hoping to have a bit more time in April to dig in, and hopefully I can flesh
out some of these ideas into something useful.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Community Conferences]]></title>
    <link href="http://rmurphey.com/blog/2012/03/08/community-conferences/"/>
    <updated>2012-03-08T08:29:00-05:00</updated>
    <id>http://rmurphey.com/blog/2012/03/08/community-conferences</id>
    <content type="html"><![CDATA[<p>In 2010, I helped put on the first TXJS. We sold our first tickets for $29, and
I think the most expensive tickets went for something like $129. We had about
200 people buy tickets, we had speakers like Douglas Crockford, Paul Irish, and
John Resig, and we had sponsors like Facebook and Google. Our total budget was
something like $30,000, and every out-of-town speaker had their travel and
accommodations paid for.</p>

<p>In May, O&#8217;Reilly Media is holding another JavaScript conference in San
Francisco, called FluentConf. I recently came to know that they are charging
$100,000 for top-tier sponsorships, and that they are offering a 10-minute
keynote as part of the package.</p>

<p>This turned my stomach, and not just because I believe it cheapens the
experience of attendees, who will pay hundreds of dollars themselves. What
really upset me was that a few weeks ago, I was approached to be on the speaker
selection committee of FluentConf, and that conversation led me to discover
that FluentConf would not be paying for speaker travel and accommodations. And
so the other day, I tweeted:</p>

<blockquote><p>conference #protip: save your money &#8211; and your speaking skills &#8211; for events that don&#8217;t sell their keynotes for $100k</p></blockquote>

<p>Last night, I was at the Ginger Man in Austin, and I checked the Twitters,
discovering that Peter Cooper, one of the chairs of FluentConf, had replied to
a conversation that arose from that tweet:</p>

<blockquote><p>@rmurphey @tomdale If you&#8217;re referring to Fluent, that is news to me.</p></blockquote>

<p>I will accept the weird fact that the co-chair of a conference didn&#8217;t know its
speaking slots were for sale &#8211; I gather that it is essentially a volunteer
role, and the co-chairs aren&#8217;t necessarily in the driver&#8217;s seat when it comes
to decisions like this. I let Peter know that, indeed, I had a PDF that
outlined all the sponsorship options.</p>

<p>This is the part where, in some alternate reality, a mutual understanding of
the offensiveness of this fact would have been achieved. What happened instead
was a whole lot of name-calling, misquoting, and general weirdness.</p>

<p>Here&#8217;s the deal. Conferences can run their event however they want, and they
can make money hand over fist. They can even claim they are the giving
JavaScript developers &#8220;an event of their own,&#8221; ignoring the existence of
the actual community-run JavaScript events that have been around for years now.  I
probably won&#8217;t go to or speak at an event that makes money hand over fist, but
I don&#8217;t have any problem with the existence of such events, or with people&#8217;s
involvement with them.  However, when a conference is making money hand over
fist &#8211; my back of the napkin calculations would suggest that FluentConf stands
to have revenues of well over a million dollars &#8211; then that conference has no
excuse not to pay the relatively paltry costs associated with speaker travel
and accommodations.</p>

<p>A conference does not exist without its speakers. Those who speak at an event
&#8211; the good ones, anyway &#8211; spend countless hours preparing and rehearsing, and
they are away from home and work for days. While I do not discount the benefits
that accrue to good speakers, the costs of being a speaker are non-trivial &#8211;
and that&#8217;s <em>before</em> you get into the dollar costs of travel and accommodations.</p>

<p>When an event is unwilling to cover even those hard costs &#8211; nevermind the
preparation time and time away from work and home &#8211; it materially affects the
selection of speakers.  It&#8217;s even worse when those same conferences claim to
desire <a href="http://fluentconf.com/fluent2012/public/content/about#diversity">diversity</a>;
the people they claim to want so badly are the very people most likely to be
discouraged when they find out they have to pay their own way to the stage.</p>

<p>In the conversation last night, I made this point:</p>

<blockquote><p>when only the people who can afford to speak can speak, then only the people who can afford to speak will
speak.</p></blockquote>

<p>Amy Hoy responded with a criticism of community-run conferences:</p>

<blockquote><p>and when only ppl who can order a ticket in 3 seconds can afford to come, only ppl who can order a ticket in 3 seconds can come</p></blockquote>

<p>I know that getting tickets to the actual community-run events is hard, but
that is because the community-run events flat-out ignore the economics of
supply and demand, choosing instead to sell tickets at affordable prices even
if it means they will sell out in a heartbeat, leaving a boatload of potential
profit on the table. And yet those events &#8211; JSConf, TXJS, and the like &#8211; have
still figured out how to cover speaker costs and provide attendees and sponsors
with unforgettable experiences.</p>

<p>When an event with revenues exceeding a million dollars is unwilling to cover
those costs, while simultaneously selling speaking slots, I do not hesitate for
a moment to call that event out, and I do not hesitate to call
on <a href="http://fluentconf.com/fluent2012/public/content/about#commitee">respected members of the community</a> to sever
their ties with the event. I&#8217;m not embarrassed about it, and you can call me all
the names you want.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mulberry: A development framework for mobile apps]]></title>
    <link href="http://rmurphey.com/blog/2011/09/18/introducing-mulberry/"/>
    <updated>2011-09-18T11:30:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/09/18/introducing-mulberry</id>
    <content type="html"><![CDATA[<p>I&#8217;ll be getting on stage in a bit at <a href="http://capitoljs.com">CapitolJS</a>, another
great event from Chris Williams, the creator of JSConf and all-around
conference organizer extraordinaire. My schtick at conferences in the past has
been to talk about the pain and pitfalls of large app development with
JavaScript, but this time is a little different: I&#8217;ll be announcing that <a href="http://toura.com">Toura Mobile</a> has created a framework built on top of PhoneGap that
aims eliminate some of those pains and pitfalls for mobile developers. We&#8217;re
calling it <a href="http://mulberry.toura.com">Mulberry</a>, and you&#8217;ll be seeing it on GitHub in the next few weeks.</p>

<p><strong>tl;dr</strong>: <a href="http://mulberry.toura.com">go here</a> and <a href="http://mulberry.toura.com/#tour">watch this video</a>.</p>

<p>While the lawyers are dotting the i&#8217;s and crossing the t&#8217;s as far as getting the code in your hands &#8211; we&#8217;re aiming for a permissive license similar to the licenses for PhoneGap and Dojo &#8211; I wanted to tell you a little bit about it.</p>

<p>Mulberry is two things. First, it&#8217;s command line tools (written in Ruby) that help you rapidly scaffold and configure an app, create content using simple Markdown and YAML, and test it in your browser, in a simulator, and on device. Second, and much more exciting to me as a JavaScript developer, it&#8217;s a framework built on top of the Dojo Toolkit for structuring an application and adding custom functionality in a sane way.</p>

<p>Mulberry lets you focus on the things that are unique to your application. It provides an underlying framework that includes a &#8220;router&#8221; for managing application state; built-in components and templates for displaying standard content types like text, audios, videos, feeds, and images; a simple API for defining custom functionality and integrating it with the system; and an HTML/CSS framework that uses SASS and HAML templates to make it easy to style your apps.</p>

<p>The basics of setting up an app are pretty well covered at the <a href="http://mulberry.toura.com">Mulberry
site</a>, but if you&#8217;re reading this, you&#8217;re probably a JavaScript developer, so I want to focus here on what Mulberry can do for you. First, though, let me back up and cover some terminology: Mulberry apps consist of a set of &#8220;nodes&#8221;; each node is assigned a template, and each template consists of components arranged in a layout. Nodes can have assets associated with them &#8211; text, audio, images, video, feeds, and data.</p>

<p>It&#8217;s the data asset that provides the most power to developers &#8211; you can create an arbitrary object, associate it with a node, and then any components that are in the template that&#8217;s being used to display the node will get access to that data.</p>

<p>A Twitter component offers a simple example. A node might have a data asset like this associated with it:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span> <span class="nx">term</span> <span class="o">:</span> <span class="s1">&#39;capitoljs&#39;</span><span class="p">,</span> <span class="nx">type</span> <span class="o">:</span> <span class="s1">&#39;twitter&#39;</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>We could define a custom template for this page (<code>mulberry create_template Twitter</code>), and tell that template to include a Twitter component:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">Twitter</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="l-Scalar-Plain">screens</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">index</span>
</span><span class='line'>      <span class="l-Scalar-Plain">regions</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="p-Indicator">-</span>
</span><span class='line'>          <span class="l-Scalar-Plain">size</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">fixed</span>
</span><span class='line'>          <span class="l-Scalar-Plain">scrollable</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>
</span><span class='line'>          <span class="l-Scalar-Plain">components</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">PageNav</span>
</span><span class='line'>        <span class="p-Indicator">-</span>
</span><span class='line'>          <span class="l-Scalar-Plain">size</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">flex</span>
</span><span class='line'>          <span class="l-Scalar-Plain">scrollable</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
</span><span class='line'>          <span class="l-Scalar-Plain">components</span><span class="p-Indicator">:</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">PageHeaderImage</span>
</span><span class='line'>            <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">custom:Twitter</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next, we&#8217;d define our Twitter component (<code>mulberry create_component Twitter</code>), which would create the skeleton of a component file:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">dojo</span><span class="p">.</span><span class="nx">provide</span><span class="p">(</span><span class="s1">&#39;client.components.Twitter&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">toura</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">&#39;Twitter&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">componentTemplate</span> <span class="o">:</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">cache</span><span class="p">(</span><span class="s1">&#39;client.components&#39;</span><span class="p">,</span> <span class="s1">&#39;Twitter/Twitter.haml&#39;</span><span class="p">),</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">prep</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">init</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>One of the things the skeleton contains is a reference to the template for the component. The <code>create_component</code> command creates this file, which defines the DOM structure for the component. For the sake of this component, that template will just need to contain one line:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="nt">%ul</span><span class="nc">.component.twitter</span>
</span></code></pre></td></tr></table></div></figure>


<p>As I mentioned earlier, Mulberry components automatically get access to all of the assets that are attached to the node they&#8217;re displaying. This information is available as an object at <code>this.node</code>. Mulberry components also have two default methods that you can implement: the <code>prep</code> method and the <code>init</code> method.</p>

<p>The <code>prep</code> method is an opportunity to prepare your data before it&#8217;s rendered using the template; we won&#8217;t use it for the Twitter component, because the Twitter component will go out and fetch its data <em>after</em> the template is rendered. This is where the <code>init</code> method comes in &#8211; this is where you can tell your component what to do. Here&#8217;s what our Twitter component ends up looking like:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">dojo</span><span class="p">.</span><span class="nx">provide</span><span class="p">(</span><span class="s1">&#39;client.components.Twitter&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">mulberry</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">&#39;Twitter&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">componentTemplate</span> <span class="o">:</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">cache</span><span class="p">(</span><span class="s1">&#39;client.components&#39;</span><span class="p">,</span> <span class="s1">&#39;Twitter/Twitter.haml&#39;</span><span class="p">),</span>
</span><span class='line'>  <span class="nx">tweetTemplate</span> <span class="o">:</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">cache</span><span class="p">(</span><span class="s1">&#39;client.components&#39;</span><span class="p">,</span> <span class="s1">&#39;Twitter/Tweet.haml&#39;</span><span class="p">),</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">init</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;twitter&#39;</span>
</span><span class='line'>        <span class="p">})[</span><span class="mi">0</span><span class="p">].</span><span class="nx">json</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="s1">&#39;http://search.twitter.com/search.json?q=&#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">term</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">dataType</span> <span class="o">:</span> <span class="s1">&#39;jsonp&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">success</span> <span class="o">:</span> <span class="nx">$</span><span class="p">.</span><span class="nx">proxy</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;_onLoad&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">_onLoad</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">tweets</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">results</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">tpl</span> <span class="o">=</span> <span class="nx">mulberry</span><span class="p">.</span><span class="nx">haml</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tweetTemplate</span><span class="p">),</span>
</span><span class='line'>        <span class="nx">html</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">tweets</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tweet</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">tweet</span><span class="p">.</span><span class="nx">link</span> <span class="o">=</span> <span class="s1">&#39;http://twitter.com/capitoljs/status/&#39;</span> <span class="o">+</span> <span class="nx">tweet</span><span class="p">.</span><span class="nx">id_str</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>          <span class="nx">tweet</span><span class="p">.</span><span class="nx">created_at</span> <span class="o">=</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">date</span><span class="p">.</span><span class="nx">locale</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span>
</span><span class='line'>            <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">tweet</span><span class="p">.</span><span class="nx">created_at</span><span class="p">),</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">datePattern</span> <span class="o">:</span> <span class="s1">&#39;EEE&#39;</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">timePattern</span> <span class="o">:</span> <span class="s1">&#39;h:m a&#39;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>          <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="nx">tweet</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">tweet</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span>
</span><span class='line'>            <span class="sr">/@(\S+)/g</span><span class="p">,</span>
</span><span class='line'>            <span class="s2">&quot;&lt;a href=&#39;http://twitter.com/#!/$1&#39;&gt;@$1&lt;/a&gt;&quot;</span>
</span><span class='line'>          <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">return</span> <span class="nx">tpl</span><span class="p">(</span><span class="nx">tweet</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">$domNode</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">html</span><span class="p">);</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">region</span><span class="p">.</span><span class="nx">refreshScroller</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note that when we define the <code>data</code> variable in the init method, we look at <code>this.node.data</code>, which is an array of all of the data objects associated with the node. We filter this array to find the first data object that is the right type &#8211; this means we can have lots of different data objects associated with a given node.</p>

<p>Note also that there&#8217;s a property <code>this.$domNode</code> that we&#8217;re calling jQuery methods on, and that we&#8217;re using jQuery&#8217;s <code>$.ajax</code> &#8211; Mulberry apps come with jQuery enabled by default, and if it&#8217;s enabled, helpers like <code>this.$domNode</code> become available to you. This means that very little knowledge of Dojo is required to start adding your own functionality to an app &#8211; if you need it, though, the full power of the Dojo Toolkit is available to you too.</p>

<p>Here&#8217;s what our component ends up looking like, with a little bit of custom CSS applied to our app:</p>

<p><img src="http://www.rebeccamurphey.com/i/4e760b2ff3b5b.jpg" title="A Mulberry app using a custom Twitter component" alt="screenshot" /></p>

<p>This is a pretty basic demo &#8211; Twitter is, indeed, the new <code>hello world</code> &#8211; but I hope it gives you a little bit of an idea about what you might be able to build with Mulberry. We&#8217;ve been using it in production to create content-rich mobile apps for our users for months now (connected to a web-based CMS instead of the filesystem, of course), and we&#8217;ve designed it specifically to be flexible enough to meet arbitrary client requests without the need to re-architect the underlying application.</p>

<p>If you know JavaScript, HTML, and CSS, Mulberry is a powerful tool to rapidly create a content-rich mobile application while taking advantage of an established infrastructure, rather than building it yourself. I&#8217;m excited to see what you&#8217;ll do with it!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Switching to Octopress]]></title>
    <link href="http://rmurphey.com/blog/2011/07/25/switching-to-octopress/"/>
    <updated>2011-07-25T08:14:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/07/25/switching-to-octopress</id>
    <content type="html"><![CDATA[<p>I&#8217;m taking a stab at starting a new blog at
<a href="http://rmurphey.com">rmurphey.com</a>, powered by
<a href="http://octopress.org/">Octopress</a>, which is a set of tools, themes, and other
goodness around a static site generator (SSG) called
<a href="https://github.com/mojombo/jekyll">jekyll</a>. A couple of people have noticed
the new site and wondered what I&#8217;m doing, so I thought I&#8217;d take a couple of
minutes to explain.</p>

<p>My old blog at <a href="http://blog.rebeccamurphey.com">blog.rebeccamurphey.com</a> is
managed using <a href="http://posterous.com">Posterous</a>. It used to be a self-hosted
WordPress site, but self-hosted WordPress sites are so 2009. One too many
attacks by hackers made it way more trouble than it seemed to be worth.
Posterous made switching from a WordPress install pretty easy, so, I did that.
All told, it took a few hours, and I was pretty happy.</p>

<p>For a few reasons, the old blog isn&#8217;t going anywhere:</p>

<ul>
<li>I ran into some trouble importing the old content into jekyll. I was tired
and I didn&#8217;t investigate the issues too much, so they&#8217;re probably solveable,
but &#8230;</li>
<li>Some of the old content just isn&#8217;t that good, and since time is a finite
resource, I don&#8217;t want to get too wrapped up in moving it over. Plus &#8230;</li>
<li>Frighteningly or otherwise, some of my posts have become reference material
on the internet. If I move them, I&#8217;ve got to deal with redirections, and I
have a feeling that&#8217;s not going to be an easy task with Posterous.</li>
</ul>


<p>In hindsight, I should have switched directly from WordPress to an SSG. Despite
my many complaints about Posterous &#8211; misformatted posts, lack of comment
hyperlinks, a sign-in requirement for commenting, and lots more &#8211; in the end
my decision to switch to a static site generator instead was more about having
easy control over my content <em>on my filesystem</em>.</p>

<p><a href="http://blog.guestlistapp.com/post/2304152860/five-reasons-to-use-a-static-site-generator-instead-of">This article</a>
explains it well, but the bottom line, I think, is that static site generators
are blogging tools for people who don&#8217;t need all the bullshit that&#8217;s been added
to online tools in the interest of making them usable by people who don&#8217;t know
wtf they&#8217;re doing. So, yes, to use an SSG, you have to know wtf you&#8217;re doing,
and for me that&#8217;s a good thing: the tool gets out of my way and lets me focus
on the writing.</p>

<p>As for Octopress, it seems pretty damn nifty &#8211; the default theme looks gorgeous on my
desktop and on my phone, and it seems they&#8217;ve taken care to put common
customization points in a single sass file. All that aside, though, one of my favorite parts
about it is that my content is truly my content. If Octopress pisses me off &#8211;
though I hope it won&#8217;t! &#8211; then I can simply take my markdown files and put
them in some other SSG, upload the whole thing to my GitHub pages, and be done
with it. Win all around.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using object literals for flow control and settings]]></title>
    <link href="http://rmurphey.com/blog/2011/07/24/object-literals/"/>
    <updated>2011-07-24T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/07/24/object-literals</id>
    <content type="html"><![CDATA[<p>I got an email the other day from someone reading through <a href="http://jqfundamentals.com">jQuery Fundamentals</a> &#8211; they&#8217;d come across the section
about patterns for performance and compression, which is based on a
presentation by <a href="http://paulirish.com">Paul Irish</a> gave back at the 2009 jQuery
Conference in Boston.</p>

<p>In that section, there&#8217;s a bit about alternative patterns for flow control &#8211;
that is, deciding what a program should do next. We&#8217;re all familiar with the
standard if statement:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">isAnimal</span><span class="p">(</span><span class="nx">thing</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">thing</span> <span class="o">===</span> <span class="s1">&#39;dog&#39;</span> <span class="o">||</span> <span class="nx">thing</span> <span class="o">===</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;yes!&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;no&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>What stumped the person who emailed me, though, was when the same logic as we
see above was written like this:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">isAnimal</span><span class="p">(</span><span class="nx">thing</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(({</span> <span class="nx">cat</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">dog</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">})[</span> <span class="nx">thing</span> <span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;yes!&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;no&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>What&#8217;s happening here is that we&#8217;re using a throwaway object literal to express
the conditions under which we will say a <code>thing</code> is an animal. We could have
stored the object in a variable first:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">isAnimal</span><span class="p">(</span><span class="nx">thing</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">animals</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">cat</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">dog</span> <span class="o">:</span> <span class="mi">1</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">animals</span><span class="p">[</span> <span class="nx">thing</span> <span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;yes!&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;no&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>However, that variable&#8217;s only purpose would be to provide this one lookup, so
it can be argued that the version that doesn&#8217;t bother setting the variable is
more economical. Reasonable people can probably disagree about whether this
economy of bytes is a good tradeoff for readability &#8211; something like this is
perfectly readable to a seasoned developer, but potentially puzzling otherwise
&#8211; but it&#8217;s an interesting example of how we can use literals in JavaScript
without bothering to store a value in a variable.</p>

<p>The pattern works with an array, too:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">animalByIndex</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">[</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span> <span class="p">][</span> <span class="nx">index</span> <span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&#8217;s also useful for looking up values generally, which is how I find myself
using it most often these days in my work with <a href="http://toura.com">Toura</a>, where
we routinely branch our code depending on the form factor of the device we&#8217;re
targeting:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">getBlingLevel</span><span class="p">(</span><span class="nx">device</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">({</span>
</span><span class='line'>    <span class="nx">phone</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">tablet</span> <span class="o">:</span> <span class="mi">200</span>
</span><span class='line'>  <span class="p">})[</span> <span class="nx">device</span><span class="p">.</span><span class="nx">type</span> <span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>As an added benefit, constructs that use this pattern will return the
conveniently falsy <code>undefined</code> if you try to look up a value that doesn&#8217;t have
a corresponding property in the object literal.</p>

<p>A great way to come across techniques like this is to read the source code of
your favorite library (and other libraries too). Unfortunately, once
discovered, these patterns can be difficult to decipher, even if you have
pretty good Google fu. Just in case your neighborhood blogger isn&#8217;t available,
IRC is alive and well in 2011, and it&#8217;s an excellent place to get access to
smart folks eager to take the time to explain.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Lessons From a Rewrite]]></title>
    <link href="http://rmurphey.com/blog/2011/07/06/lessons-from-a-rewrite/"/>
    <updated>2011-07-06T10:50:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/07/06/lessons-from-a-rewrite</id>
    <content type="html"><![CDATA[<p>MVC and friends have been around for decades, but it’s only in the last couple
of years that broad swaths of developers have started applying those patterns
to JavaScript. As that awareness spreads, developers eager to use their
newfound insight are presented with a target-rich environment, and the
temptation to rewrite can be strong.</p>

<blockquote><p>There’s a subtle reason that programmers always want to throw away the code
and start over. The reason is that they think the old code is a mess. … The reason
that they think the old code is a mess is because of a cardinal, fundamental
law of programming: It’s harder to read code than to write it. - <a href="http://www.joelonsoftware.com/articles/fog0000000069.html"> Joel Spolsky
</a></p></blockquote>

<p>When I started working with <a href="http://toura.com/"> Toura Mobile </a> late last year, they already had
a product: a web-based CMS to create the structure of a mobile application and
populate it with content, and a PhoneGap-based application to consume the
output of the CMS inside a native application. Customers were paying, but the
development team was finding that delivering new features was a struggle, and
bug fixes seemed just as likely to break something else as not. They contacted
me to see whether they should consider a rewrite.</p>

<p>With due deference to Spolsky, I don’t think it was a lack of readability
driving their inclination to rewrite. In fact, the code wasn’t all that
difficult to read or follow. The problem was that the PhoneGap side of things
had been written to solve the problems of a single-purpose, one-off
application, and it was becoming clear that it needed to be a flexible,
extensible delivery system for all of the content combinations clients could
dream up. It wasn’t an app — it was an app that made there be an app.</p>

<blockquote><p>Where a new system concept or new technology is used, one has to build a system
to throw away, for even the best planning is not so omniscient as to get it
right the first time. Hence plan to throw one away; you will, anyhow. - Fred
Brooks, <a href="http://en.wikipedia.org/wiki/The_Mythical_Man-Month"> The Mythical Man Month </a></p></blockquote>

<p>By the time I’d reviewed the code and started writing up my findings, the
decision had already been made: Toura was going to throw one away and start
from scratch. For four grueling and exciting months, I helped them figure out
how to do it better the second time around. In the end, I like to think we’ve
come up with a solid architecture that’s going to adapt well to clients’
ever-changing needs. Here, then, are some of the lessons we learned along the
way.</p>

<h2>Understand what you’re rewriting</h2>

<p>I had spent only a few days with the codebase when we decided that we were
going to rewrite it. In some ways, this was good — I was a fresh set of eyes,
someone who could think about the system in a new way — but in other ways, it
was a major hindrance. We spent a lot of time at the beginning getting me up to
speed on what, exactly, we were making; things that went without saying for
existing team members did not, in fact, go without saying for me.</p>

<p>This constant need for explanation and clarification was frustrating at times,
both for me and for the existing team, but it forced us to state the problem in
plain terms. The value of this was incredible — as a team, we were far less
likely to accept assumptions from the original implementation, even assumptions
that seemed obvious.</p>

<p>One of the key features of Toura applications is the ability to update them
“over the air” — it’s not necessary to put a new version in an app store in
order to update an app’s content or even its structure. In the original app,
this was accomplished via generated SQL diffs of the data. If the app was at
version 3, and the data in the CMS was at version 10, then the app would
request a patch file to upgrade version 3 to version 10. The CMS had to
generate a diff for all possible combinations: version 3 to version 10, version
4 to version 10, etc. The diff consisted of queries to run against an SQLite
database on the device. Opportunities for failures or errors were rampant,
a situation exacerbated by the async nature of the SQLite interface.</p>

<p>In the new app, we replicated the feature with vastly less complexity
— whenever there is an update, we just make the full data available at an
app-specific URL as a JSON file, using the same format that we use to provide
the initial data for the app on the device. The new data is stored on the
device, but it’s also retained in memory while the application is running via
Dojo’s Item File Read Store, which allows us to query it synchronously. The
need for version-by-version diffs has been eliminated.</p>

<p>Restating the problem led to a simpler, more elegant solution that greatly
reduced the opportunities for errors and failure. As an added benefit, using
JSON has allowed us to meet needs that we never anticipated — the flexibility
it provides has become a valuable tool in our toolbox.</p>

<h2>Identify pain points</h2>

<p>If the point of a rewrite is to make development easier, then an important step
is to figure out what, exactly, is making development hard. Again, this was
a time to question assumptions — as it turned out, there were things that had
come to be accepted burdens that were actually relatively easy to address.</p>

<p>One of the biggest examples of this was the time required to develop and test
anything that might behave differently on one operating system versus another.
For example, the Android OS has limited support for the audio and video tags,
so a native workaround is required to play media on Android that is not
required on iOS.</p>

<p>In the original code, this device-specific branching was handled in a way that
undoubtedly made sense at the beginning but grew unwieldy over time. Developers
would create Mustache templates, wrapping the template tags in <code>/* */</code> so the
templates were actually executable, and then compile those templates into plain
JavaScript files for production. Here are a few lines from one of those
templates:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="cm">/*  */</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">mediaPath</span> <span class="o">=</span> <span class="s2">&quot;www/media/&quot;</span> <span class="o">+</span> <span class="nx">toura</span><span class="p">.</span><span class="nx">pages</span><span class="p">.</span><span class="nx">currentId</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">;</span>
</span><span class='line'><span class="cm">/*  */</span>
</span><span class='line'><span class="cm">/*  */</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">mediaPath</span> <span class="o">=</span> <span class="p">[</span><span class="nx">Toura</span><span class="p">.</span><span class="nx">getTouraPath</span><span class="p">(),</span> <span class="nx">toura</span><span class="p">.</span><span class="nx">pages</span><span class="p">.</span><span class="nx">currentId</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">);</span>
</span><span class='line'><span class="cm">/*  */</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">imagesList</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">dimensionsList</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">namesList</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">thumbsList</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="cm">/*  */</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="cm">/*  */</span>
</span></code></pre></td></tr></table></div></figure>


<p>These templates were impossible to check with a code quality tool like JSHint,
because it was standard to declare the same variable multiple times. Multiple
declarations of the same variable meant that the order of those declarations
was important, which made the templates tremendously fragile. The theoretical
payoff was smaller code in production, but the cost of that byte shaving was
high, and the benefit somewhat questionable — after all, we’d be delivering the
code directly from the device, not over HTTP.</p>

<p>In the rewrite, we used a simple configuration object to specify information
about the environment, and then we look at the values in that configuration
object to determine how the app should behave. The configuration object is
created as part of building a production-ready app, but in development we can
alter configuration settings at will. Simple <code>if</code> statements replaced fragile
template tags.</p>

<p>Since Dojo allows specifying code blocks for exclusion based on the settings
you provide to the build process, we could mark code for exclusion if we really
didn’t want it in production.</p>

<p>By using a configuration object instead of template tags for branching, we
eliminated a major pain point in day-to-day development. While nothing matches
the proving ground of the device itself, it’s now trivial to effectively
simulate different device experiences from the comfort of the browser. We do
the majority of our development there, with a high degree of confidence that
things will work mostly as expected once we reach the device. If you’ve ever
waited for an app to build and install to a device, then you know how much
faster it is to just press Command-R in your browser instead.</p>

<h2>Have a communication manifesto</h2>

<p>Deciding that you’re going to embrace an MVC-ish approach to an application is
a big step, but only a first step — there are a million more decisions you’re
going to need to make, big and small. One of the widest-reaching decisions to
make is how you’ll communicate among the various pieces of the application.
There are all sorts of levels of communication, from application-wide state
management — what page am I on? — to communication between UI components — when
a user enters a search term, how do I get and display the results?</p>

<p>From the outset, I had a fairly clear idea of how this should work based on
past experiences, but at first I took for granted that the other developers
would see things the same way I did, and I wasn’t necessarily consistent
myself. For a while we had several different patterns of communication,
depending on who had written the code and when. Every time you went to use
a component, it was pretty much a surprise which pattern it would use.</p>

<p>After one too many episodes of frustration, I realized that part of my job was
going to be to lay down the law about this — it wasn’t that my way was more
right than others, but rather that we needed to choose a way, or else reuse and
maintenance was going to become a nightmare. Here’s what I came up with:</p>

<ul>
<li><code>myComponent.set(key, value)</code> to change state (with the help of setter
methods from Dojo’s <a href="http://dojotoolkit.org/reference-guide/dijit/_Widget.html">dijit._Widget mixin</a>)</li>
<li><code>myComponent.on&amp;lt;Event&amp;gt;(componentEventData)</code> to announce state changes
and user interaction; Dojo lets us
<a href="http://dojotoolkit.org/reference-guide/dojo/connect.html">connect</a> to the
execution of arbitrary methods, so other pieces could listen for these
methods to be executed.</li>
<li><code>dojo.publish(topic, [ data ])</code> to announce occurrences of app-wide interest,
such as when the window is resized</li>
<li><code>myComponent.subscribe(topic)</code> to allow individual components react to
published topics</li>
</ul>


<p>Once we spelled out the patterns, the immediate benefit
wasn’t maintainability or reuse; rather, we found that we didn’t have to make
these decisions on a component-by-component basis anymore, and we could focus
on the questions that were actually unique to a component. With conventions
we could rely on, we were constantly discovering new ways to abstract and DRY
our code, and the consistency across components meant it was easier to work
with code someone else had written.</p>

<h2>Sanify asynchronicity</h2>

<p>One of the biggest challenges of JavaScript development — well, besides working
with the DOM — is managing the asynchronicity of it all. In the old system,
this was dealt with in various ways: sometimes a method would take a success
callback and a failure callback; other times a function would return an object
and check one of its properties on an interval.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">images</span> <span class="o">=</span> <span class="nx">toura</span><span class="p">.</span><span class="nx">sqlite</span><span class="p">.</span><span class="nx">getMedias</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="s2">&quot;image&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">onGetComplete</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">images</span><span class="p">.</span><span class="nx">incomplete</span><span class="p">)</span>
</span><span class='line'>    <span class="k">return</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">onGetComplete</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">showImagesHelper</span><span class="p">(</span><span class="nx">images</span><span class="p">.</span><span class="nx">objs</span><span class="p">,</span> <span class="nx">choice</span><span class="p">)</span>
</span><span class='line'><span class="p">},</span><span class="mi">10</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>The problem here, of course, is that if <code>images.incomplete</code> never gets set to
false — that is, if the <code>getMedias</code> method fails — then the interval will never
get cleared. Dojo and now jQuery (since version 1.5) offer a facility for
handling this situation in an elegant and powerful way. In the new version of
the app, the above functionality looks something like this:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">toura</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">Data</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="err">‘</span><span class="nx">image</span><span class="err">’</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">showImages</span><span class="p">,</span> <span class="nx">showImagesFail</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>get</code> method of <code>toura.app.Data</code> returns an <a href="http://www.sitepen.com/blog/2010/05/03/robust-promises-with-dojo-deferred-1-5/">immutable promise</a>
— the promise’s then method makes the resulting value of the asynchronous get
method available to <code>showImages</code>, but does not allow <code>showImages</code> to alter the
value. The promise returned by the get method can also be stored in a variable,
so that additional callbacks can be attached to it.</p>

<p>Using promises vastly simplifies asynchronous code, which can be one of the
biggest sources of complexity in a non-trivial application. By using promises,
we got code that was easier to follow, components that were thoroughly
decoupled, and new flexibility in how we responded to the outcome of an
asynchronous operation.</p>

<h2>Naming things is hard</h2>

<p>Throughout the course of the rewrite we were constantly confronted with one of
those pressing questions developers wrestle with: what should I name this
variable/module/method/thing? Sometimes I would find myself feeling slightly
absurd about the amount of time we’d spend naming a thing, but just recently
I was reminded how much power those names have over our thinking.</p>

<p>Every application generated by the Toura CMS consists of a set of “nodes,”
organized into a hierarchy. With the exception of pages that are standard
across all apps, such as the search page, the base content type for a page
inside APP is always a node — or rather, it was, until the other day. I was
working on a new feature and struggling to figure out how I’d display a piece
of content that was unique to the app but wasn’t really associated with a node
at all. I pored over our existing code, seeing the word node on what felt like
every other line. As an experiment, I changed that word node to baseObj in
a few high-level files, and suddenly a whole world of solutions opened up to me
— the name of a thing had limiting my thinking.</p>

<p>The lesson here, for me, is that the time we spent (and spend) figuring out
what to name a thing is not lost time; perhaps even more importantly, the goal
should be to give a thing the most generic name that still conveys what the
thing’s job — in the context in which you’ll use the thing — actually is.</p>

<h2>Never write large apps</h2>

<p>I touched on this earlier, but if there is one lesson I take from every large
app I’ve worked on, it is this:</p>

<blockquote><p>The secret to building large apps is never build large apps. Break up your
applications into small pieces. Then, assemble those testable, bite-sized
pieces into your big application. - Justin Meyer</p></blockquote>

<p>The more tied components are to each other, the less reusable they will be, and
the more difficult it becomes to make changes to one without accidentally
affecting another. Much like we had a manifesto of sorts for communication
among components, we strived for a clear delineation of responsibilities among
our components. Each one should do one thing and do it well.</p>

<p>For example, simply rendering a page involves several small, single-purpose
components:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">nodeRoute</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">nodeId</span><span class="p">,</span> <span class="nx">pageState</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">pageState</span> <span class="o">=</span> <span class="nx">pageState</span> <span class="o">||</span> <span class="p">{};</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">nodeModel</span> <span class="o">=</span> <span class="nx">toura</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">Data</span><span class="p">.</span><span class="nx">getModel</span><span class="p">(</span><span class="nx">nodeId</span><span class="p">),</span>
</span><span class='line'>      <span class="nx">page</span> <span class="o">=</span> <span class="nx">toura</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">UI</span><span class="p">.</span><span class="nx">getCurrentPage</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">nodeModel</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">toura</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">home</span><span class="p">();</span>
</span><span class='line'>    <span class="k">return</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">page</span> <span class="o">||</span> <span class="o">!</span><span class="nx">page</span><span class="p">.</span><span class="nx">node</span> <span class="o">||</span> <span class="nx">nodeId</span> <span class="o">!==</span> <span class="nx">page</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">page</span> <span class="o">=</span> <span class="nx">toura</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">PageFactory</span><span class="p">.</span><span class="nx">createPage</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="nx">nodeModel</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">page</span><span class="p">.</span><span class="nx">failure</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">toura</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">back</span><span class="p">();</span>
</span><span class='line'>      <span class="k">return</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">toura</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">UI</span><span class="p">.</span><span class="nx">showPage</span><span class="p">(</span><span class="nx">pf</span><span class="p">,</span> <span class="nx">nodeModel</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">page</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">pageState</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// record node pageview if it is node-only</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">nodeId</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">pageState</span><span class="p">.</span><span class="nx">assetType</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">dojo</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;/node/view&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="nx">route</span><span class="p">.</span><span class="nx">hash</span> <span class="p">]);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The router observes a URL change, parses the parameters for the route from the
URL, and passes those parameters to a function. The Data component gets the
relevant data, and then hands it to the PageFactory component to generate the
page. As the page is generated, the individual components for the page are also
created and placed in the page. The PageFactory component returns the generated
page, but at this point the page is not in the DOM. The UI component receives
it, places it in the DOM, and handles the animation from the old page to the
new one.</p>

<p>Every step is its own tiny app, making the whole process tremendously testable.
The output of one step may become the input to another step, but when input and
output are predictable, the questions our tests need to answer are trivial:
“When I asked the Data component for the data for node123, did I get the data
for node123?”</p>

<p>Individual UI components are their own tiny apps as well. On a page that
displays a videos node, we have a video player component, a video list
component, and a video caption component. Selecting a video in the list
announces the selection via the list’s onSelect method. Dojo allows us to
connect to the execution of object methods, so in the page controller, we have
this:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">this</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">videoList</span><span class="p">,</span> <span class="s1">&#39;onSelect&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">assetId</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">video</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="err">\</span><span class="nx">_videoById</span><span class="p">(</span><span class="nx">assetId</span><span class="p">);</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">videoCaption</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="nx">video</span><span class="p">.</span><span class="nx">caption</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">videoPlayer</span><span class="p">.</span><span class="nx">play</span><span class="p">(</span><span class="nx">assetId</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>The page controller receives the message and passes it along to the other
components that need to know about it — components don’t communicate directly
with one another. This means the component that lists the videos can list
anything, not just videos — its only job is to announce a selection, not to do
anything as a result.</p>

<h2>Keep rewriting</h2>

<blockquote><p>It takes confidence to throw work away … When people first start drawing,
they’re often reluctant to redo parts that aren’t right … they convince
themselves that the drawing is not that bad, really — in fact, maybe they meant
it to look that way. - <a href="http://www.paulgraham.com/taste.html">Paul Graham, “Taste for Makers”</a></p></blockquote>

<p>The blank slate offered by a rewrite allows us to fix old mistakes, but
inevitably we will make new ones in the process. As good stewards of our code,
we must always be open to the possibility of a better way of doing a thing. “It
works” should never be mistaken for “it’s done.”</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A new chapter]]></title>
    <link href="http://rmurphey.com/blog/2011/05/31/a-new-chapter/"/>
    <updated>2011-05-31T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/05/31/a-new-chapter</id>
    <content type="html"><![CDATA[<p>It was three years ago this summer that I <a href="http://blog.rebeccamurphey.com/2-years-in-some-thoughts-on-working-for-mysel">got the call, bought the Yuengling, smoked the cigarettes</a>, and began life as an independent consultant. It&rsquo;s been (almost) three years of ups and downs, and, eventually, among the most rewarding experiences of my life. Day by day, I wrote my own job description, found my own clients, set my own schedule, and set my own agenda.</p>




<p>Starting tomorrow, it&rsquo;s time for a new chapter in my working life: I&rsquo;ll be joining <a href="http://toura.com">Toura Mobile</a> full-time as their lead JavaScript developer, continuing my work with them on creating a PhoneGap- and Dojo-based platform for the rapid creation of content-rich mobile applications.</p>




<p>I&rsquo;ve been working with Toura for about six months now, starting shortly after I met <a href="http://twitter.com/MattRogish">Matt Rogish</a>, their director of development, at a JavaScript event in New York. They brought me on as a consultant to review their existing application, and the eventual decision was to rewrite it from the ground up, using the lessons learned and knowledge gained from the first version to inform the second. It was a risky decision, but it&rsquo;s paid off: earlier this year, Toura started shipping apps built with the rewritten system, and the care we took to create modular, loosely coupled components from the get-go has paid off immensely, meeting current needs while making it easier to develop new features. With the rewrite behind us, these days we&rsquo;re using the solid foundation we built to allow users of the platform to create ever more customized experiences in their applications.</p>




<p>If you know me at all, you know that I&rsquo;ve been pretty die-hard about being an independent consultant, so you might think this was a difficult decision. Oddly, it wasn&rsquo;t &mdash; I&rsquo;ve enjoyed these last several months immensely, the team I work with is fantastic, and I&rsquo;ve never felt more proud of work I&rsquo;ve done. Whenever I found myself wondering whether Toura might eventually tire of paying my consulting rates, I&rsquo;d get downright mopey. Over the course of three years, I&rsquo;ve worked hard for all of my clients, but this is the first time I&rsquo;ve felt so invested in a project&rsquo;s success or failure, like there was a real and direct correlation between my efforts and the outcome. It&rsquo;s a heady feeling, and I hope and expect it to continue for a while.</p>




<p>By the way, I&rsquo;ll be talking about the rewrite at both <a href="http://2011.texasjavascript.com">TXJS</a> and <a href="http://gothamjs.com">GothamJS</a> in the next few weeks.</p>




<p>Also: <a href="http://toura.com/about/jobs/">we&rsquo;re hiring</a> :)</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Getting Better at JavaScript]]></title>
    <link href="http://rmurphey.com/blog/2011/05/20/getting-better-at-javascript/"/>
    <updated>2011-05-20T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/05/20/getting-better-at-javascript</id>
    <content type="html"><![CDATA[<p>I seem to be getting a lot of emails these days asking a deceptively simple
question: “How do I get better at JavaScript?” What follows are some
semi-random thoughts on the subject:</p>

<p>The thing that I’ve come to realize about these questions is that some things
just take time. I wish I could write down “Ten Things You Need to Know to Make
You Amazing at the JavaScript,” but it doesn’t work that way. Books are
fantastic at exposing you to guiding principles and patterns, but if your brain
isn’t ready to connect them with real-world problems, it won’t.</p>

<p><strong>The number one thing that will make you better at writing JavaScript is writing
JavaScript.</strong> It’s OK if you cringe at it six months from now. It’s OK if you
know it could be better if you only understood X, Y, or Z a little bit better.
<a href="http://www.paulgraham.com/taste.html"> Cultivate dissatisfaction </a>, and fear the day when you aren’t disappointed with
the code you wrote last month.</p>

<p>Encounters with new concepts are almost always eventually rewarding, but in the
short term I’ve found they can be downright demoralizing if you’re not aware of
the bigger picture. The first step to being better at a thing is realizing you
could be better at that thing, and initially that realization tends to involve
being overwhelmed with all you don’t know. The first <a href="http://jsconf.us/2009/"> JSConf </a>, in 2009, was
exactly this for me. I showed up eager to learn but feeling pretty cocky about
my skills. I left brutally aware of the smallness of my knowledge, and it was a
transformational experience: getting good at a thing involves seeking out
opportunities to feel small.</p>

<p>One of the most helpful things in my learning has been having access to smart
people who are willing to answer my questions and help me when I get stuck.
Meeting these people and maintaining relationships with them is hard work, and
it generally involves interacting with them in real life, not just on the
internet, but the dividends of this investment are unfathomable.</p>

<p>To that end, attend conferences. Talk to the speakers and ask them questions.
Write them emails afterwards saying that it was nice to meet them. Subscribe to
their blogs. Pay attention to what they’re doing and evangelize their good
work.</p>

<p>Remember, too, that local meetups can be good exposure to new ideas too, even
if on a smaller scale. The added bonus of local meetups is that the people
you’ll meet there are … local! It’s easy to maintain relationships with them
and share in learning with them in real life.</p>

<p>(An aside: If your company won’t pay for you to attend any conferences, make
clear how short-sighted your company’s decision is and start looking for a new
job, because your company does not deserve you. Then, if you can, cough up the
money and go anyway. As a self-employed consultant, I still managed to find
something like $10,000 to spend on travel- and conference-related expenses last
year, and I consider every penny of it to be money spent on being better at
what I do. When I hear about big companies that won’t fork over even a fraction
of that for an employee who is raising their hand and saying “help me be better
at what I do!”, I rage.)</p>

<p>Make a point of following the bug tracker and repository for an active
open-source project. Read the bug reports. Try the test cases. Understand the
commits. I admit that I have never been able to make myself do this for
extended periods of time, but I try to drop in on certain projects now and then
because it exposes me to arbitrary code and concepts that I might not otherwise
run into.</p>

<p>Read the source for your favorite library, and refer to it when you need to
know how a method works. Consult the documentation when there’s some part of
the source you don’t understand. When choosing tools and plugins, read the
source, and see whether there are things you’d do differently.</p>

<p>Eavesdrop on communities, and participate when you have something helpful to
add. Lurk on a mailing list or a forum or in an IRC channel, help other people
solve problems. If you’re not a <a href="http://slash7.com/2006/12/22/vampires/"> help vampire </a> — if you give more than you take —
the “elders” of a community will notice, and you will be rewarded with their
willingness to help you when it matters.</p>

<p>Finally, books:</p>

<ul>
<li>JavaScript: The Good Parts, by Douglas Crockford. It took me more than one
try to get through this not-very-thick book, and it is not gospel. However,
it is mandatory reading for any serious JavaScript developer.</li>
<li><a href="http://eloquentjavascript.net/"> Eloquent JavaScript </a>, Marijn Haverbeke (also in print). This is another book
that I consider mandatory; you may not read straight through it, but you
should have it close at hand. I like it so much that I actually bought the
print version, and then was lucky enough to get a signed copy from Marijn at
JSConf 2011.</li>
<li>JavaScript Patterns, by Stoyan Stefanov. This was the book that showed me
there were names for so many patterns that I’d discovered purely through
fumbling around with my own code. I read it on the flight to the 2010 Boston
jQuery Conference, and it’s definitely the kind of book that I wouldn’t have
gotten as much out of a year earlier, when I had a lot less experience with
the kinds of problems it addresses.</li>
<li>Object-Oriented JavaScript, by Stoyan Stefanov. It’s been ages since I read
this book, and so I confess that I don’t have a strong recollection of it,
but it was probably the first book I read that got me thinking about
structuring JavaScript code beyond the “get some elements, do something with
them” paradigm of jQuery.</li>
</ul>


<p>Good luck.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Objects as Arguments: Where do you draw the line?]]></title>
    <link href="http://rmurphey.com/blog/2011/04/25/objects-as-arguments/"/>
    <updated>2011-04-25T11:16:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/04/25/objects-as-arguments</id>
    <content type="html"><![CDATA[<p>I was reviewing some code last week and came across a snippet that looked a lot like this:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">someObject</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// ...</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">onSuccess</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// ...</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">someMethod</span><span class="p">(</span><span class="nx">resp</span><span class="p">.</span><span class="nx">token</span><span class="p">,</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">host</span><span class="p">,</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">secret</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">someMethod</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">host</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">secret</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// ...</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>My immediate response was to suggest that it didn&#8217;t make sense to be passing
four separate arguments to <code>someMethod</code>, especially when the arguments were
being &#8220;unpacked&#8221; from an already-existing object. Certainly we could just pass
the <code>resp</code> object directly to <code>someMethod</code>, and let <code>someMethod</code> unpack it as
necessary &#8211; we&#8217;d save some bytes, and we&#8217;d also leave ourselves some room to
grow. &#8220;I&#8217;m not a big fan of functions that take four arguments,&#8221; I said in my
GitHub comment.</p>

<p>To the original author&#8217;s credit, &#8220;because I say so&#8221; wasn&#8217;t sufficient reason to
rewrite code that was working just fine, thank you very much. If four arguments
was too many, was two arguments too many? Why draw the line at four? Surely the
four-argument signature helped indicate to future developers what was required
in order for the function to &#8230; function. Right? My hackles momentarily
raised, I parried by pointing out that if the arguments were actually required
by the function, maybe the function ought to actually check for their presence
before using them. Ha! While the original author was distracted by my disarming
logic, I fretted over the fact that I use a function that take four arguments
every day: <code>dojo.connect(node, 'click', contextObj, 'handlerMethod')</code>. Ohnoes.</p>

<p>So where do you draw the line? Certainly you could write that <code>dojo.connect</code>
call like so:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">dojo</span><span class="p">.</span><span class="nx">connect</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">node</span> <span class="o">:</span> <span class="nx">node</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">event</span> <span class="o">:</span> <span class="s1">&#39;click&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">context</span> <span class="o">:</span> <span class="nx">contextObj</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">method</span> <span class="o">:</span> <span class="s1">&#39;handlerMethod&#39;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>This, though, might make you poke your eyes out. It certainly isn&#8217;t as concise
as the four-argument approach, and it makes a lot of things like
<a href="http://ejohn.org/blog/partial-functions-in-javascript/">partial</a>
<a href="http://dojotoolkit.org/reference-guide/dojo/partial.html#dojo-partial">application</a>
a lot harder. Clearly there&#8217;s more to this than &#8220;if there&#8217;s more than four
arguments, put them in an object&#8221; &#8230; but what are the rules?</p>

<h2>Optional Arguments</h2>

<p>Probably the most compelling reason to use an object is when there are several
optional arguments. For example, last fall I was reviewing some code from a
potential training client, and I came across this:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">addBling</span><span class="p">(</span><span class="s1">&#39;#awesome&#39;</span><span class="p">,</span> <span class="s1">&#39;fuchsia&#39;</span><span class="p">,</span> <span class="s1">&#39;slow&#39;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;done!&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>No one can argue that this is not terrible, and yet every experienced
JavaScript developer knows how the developer(s) who wrote it arrived there. At
first, the function needed three arguments, and all was good with the world.
But then, it seemed like the same function could be used to do another thing by
just passing two more arguments &#8211; no big deal, because if those two arguments
weren&#8217;t present, then just the first three would suffice. Five arguments
certainly isn&#8217;t <em>that</em> bad, right? After that, though, things went south: for
whatever undoubtedly marketing-department-driven reason, suddenly both the
original three-argument case and the later five-argument case both needed to
receive two more arguments, and these two new arguments were mandatory. Now
both cases had seven-argument signatures, and in some cases, two of those seven
arguments needed to be null so nothing would break.</p>

<p>This case demonstrates the most compelling reason to switch to using an object
instead: optional arguments. When the developer discovered that the original,
three-argument <code>addBling</code> could be used for the five-argument case as well, it
was probably time to refactor:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// original</span>
</span><span class='line'><span class="nx">addBling</span><span class="p">(</span><span class="s1">&#39;#awesome&#39;</span><span class="p">,</span> <span class="s1">&#39;fuchsia&#39;</span><span class="p">,</span> <span class="s1">&#39;slow&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// new hotness</span>
</span><span class='line'><span class="nx">addBling</span><span class="p">(</span><span class="s1">&#39;#awesome&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">color</span> <span class="o">:</span> <span class="s1">&#39;fuchsia&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">speed</span> <span class="o">:</span> <span class="s1">&#39;slow&#39;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, the same function could be used while passing it more information about
how to behave in the five-argument case:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">addBling</span><span class="p">(</span><span class="s1">&#39;#omgSoAwesome&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">color</span> <span class="o">:</span> <span class="s1">&#39;fuchsia&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">speed</span> <span class="o">:</span> <span class="s1">&#39;slow&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">unicorns</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">rainbows</span> <span class="o">:</span> <span class="mi">5</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, when it came time to add yet more bling, the function signature wouldn&#8217;t need to change,</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">addBling</span><span class="p">(</span><span class="s1">&#39;#awesome&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">color</span> <span class="o">:</span> <span class="s1">&#39;fuchsia&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">speed</span> <span class="o">:</span> <span class="s1">&#39;slow&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">timesToBlink</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">alertOnSuccess</span> <span class="o">:</span> <span class="s1">&#39;done!&#39;</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">addBling</span><span class="p">(</span><span class="s1">&#39;#omgSoAwesome&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">color</span> <span class="o">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">speed</span> <span class="o">:</span> <span class="s1">&#39;fast&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">unicorns</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">rainbows</span> <span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">timesToBlink</span> <span class="o">:</span> <span class="mi">9001</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">alertOnSuccess</span> <span class="o">:</span> <span class="s1">&#39;woohoo!&#39;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Extensibility and Future-Proofing</h2>

<p>Another case for passing in an object is when you want the flexibility that an
object provides, even if your code doesn&#8217;t require it for now:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">firstName</span><span class="p">;</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>For now, you only want to be able to provide the first and last name of the
person &#8211; it would work just fine to create a function signature for the
<code>Person</code> constructor that took exactly those two arguments, because indeed they
are required. On the other hand, though, this is incredibly short-sighted &#8211;
while first and last name may be all that you care about now, there&#8217;s obviously
more to a person than those two attributes, and eventually you may want to
provide attributes such as age, occupation, etc. Doing this with individual
arguments quickly becomes unsustainable. Besides that, though, it also makes
assigning instance properties a pain in the ass. By passing an object, we can
rewrite the above code as such:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Person</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">dojo</span><span class="p">.</span><span class="nx">mixin</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">// jQuery: $.extend(this, args);</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now &#8211; assuming this is what we want &#8211; we can mix in <em>any</em> settings we provide
in the <code>args</code> argument. Dojo, for example, bakes this ability in to anything
that inherits from <code>dijit._Widget</code>:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">thinger</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">my</span><span class="p">.</span><span class="nx">Thinger</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">title</span> <span class="o">:</span> <span class="s1">&#39;Favorite Animals&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">animals</span> <span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;Narwhal&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemur&#39;</span><span class="p">,</span> <span class="s1">&#39;Honey Badger&#39;</span> <span class="p">]</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Use Objects for Related Data</h2>

<p>An important qualifier here is that all of the properties of an object that
we&#8217;ve talked about passing to our <code>Person</code> constructor are related &#8211; they all
are saying something about the Person you&#8217;re creating. What if creating our
Person was asynchronous, and we wanted to run a function once our Person was
created? In a (contrived) case like that, I think it does make sense to pass in
a separate argument:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="nx">configObj</span><span class="p">,</span> <span class="nx">fn</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this particular example, we still only have two arguments &#8211; we haven&#8217;t
wandered into that muddy realm of four or more. That said, I think this
distinction is part of what makes <code>dojo.connect(node, 'click', contextObj,
'handlerMethod')</code> OK: the arguments are four distinctly different types of
information. Taken together, they have an almost narrative quality: when this
node receives a click, use the context object&#8217;s <code>handlerMethod</code>. A signature
like <code>new Person('Rebecca', 'Murphey', 34, 'web developer', 2 /*cats*/, 2
/*dogs*/)</code> doesn&#8217;t <em>feel</em> the same as the <code>dojo.connect</code> example &#8211; it&#8217;s
information that&#8217;s too related to be expressed as independent arguments.</p>

<h2>Four or More, Time to Refactor?</h2>

<p>I think the bottom line here is a) it&#8217;s complicated, and b) if your function
signature has four or more arguments, you should almost certainly consider
whether there&#8217;s a better way to do it. If the arguments are super-related, it
may be they belong in an object, so you get the benefit of easy extensibility
down the road. If there are optional arguments, you almost certainly want to
wrap those in an object to avoid passing <code>null</code> over and over again.</p>

<p>Personally, my threshold is actually closer to two arguments &#8211; if I find
myself wanting a third argument, I question whether my function is trying to do
more than it should be doing &#8211; maybe I should do some pre-processing of the
input so I can get away with just passing in two arguments. Every additional
argument is an indication of additional complexity, which means an additional
opportunity for things to go wrong.</p>

<h2>Other Considerations</h2>

<p>I posed this question to
<a href="http://twitter.com/#!/rmurphey/status/62172041037623296">Twitter</a> and got a
ton of interesting feedback. Here are some of the highlights that I didn&#8217;t
cover above:</p>

<ul>
<li><a href="https://twitter.com/raydaly/status/62320791232069632">@raydaly</a> no new nouns
is my principle. If unrelated data needs to be passed, diff args.</li>
<li><a href="https://twitter.com/dadaxl/status/62308649699250176">@dadaxl</a> I would pass
an obj if I&#8217;ve a dynamic bunch of args containing functions.</li>
<li><a href="https://twitter.com/sh1mmer/status/62308597153021952">@sh1mmer</a> omg! Objects
for the love of god! No one likes immutable APIs. Just ask @ls_n</li>
<li><a href="https://twitter.com/mattrogish/status/62307288597266432">@MattRogish</a> Rails
tends to do required things are named args, optional things are a hash</li>
<li><a href="https://twitter.com/ryanflorence/status/62511600837468161">@ryanflorence</a>
obfuscation often influences me, objects don&#8217;t compress as well as multiple
args.</li>
<li><a href="https://twitter.com/getify/status/62512606132449280">@getify</a> if more than
half of the args are optional&#8230;or if there are several boolean params which
without names can be confusing</li>
<li><a href="https://twitter.com/jcoglan/status/62253184369954816">@jcoglan</a> When further
args are optional, or args.length&gt;3. Need to spot when options merit a
refactoring, though.</li>
<li><a href="https://twitter.com/digitalicarus/status/62247330354692096">@digitalicarus</a>
A combo of sheer length, amount of reuse, if it&#8217;s an API, and/or if it&#8217;s
designed to be called a variety of ways to a similar end.</li>
<li><a href="https://twitter.com/bryanforbes/status/62237053148086272">@BryanForbes</a> If I
have to start swapping arguments and type checking, it&#8217;s time for one object
or reworking my function.</li>
<li><a href="https://twitter.com/myfreeweb/status/62229278581993472">@myfreeweb</a> I use an
object when I start forgetting the order of args &#8230; or there is no logical
order like (key, value, callback) at all</li>
<li><a href="https://twitter.com/zetafleet/status/62209835097268224">@zetafleet</a> When
many of the arguments are optional or they&rsquo;re all getting stored or
copied directly over to the object.</li>
<li><a href="https://twitter.com/maravillas/status/62176422877335552">@maravillas</a> I
usually don&#8217;t make an obj just for passing data; if arglist is too long,
maybe the function does too much and needs refactoring.</li>
</ul>


<h2>Postscript</h2>

<p>We ended up leaving the code that spurred this whole conversation exactly as it
was.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Modern JavaScript]]></title>
    <link href="http://rmurphey.com/blog/2011/04/15/modern-javascript/"/>
    <updated>2011-04-15T11:16:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/04/15/modern-javascript</id>
    <content type="html"><![CDATA[<p>My presentation <a href="http://www.slideshare.net/rmurphey/the-jquery-divide-5287573">the jQuery Divide</a> (<a href="http://jsconf.eu/2010/speaker/the_jquery_divide_by_rebecca_m.html">video here</a>) has been <a href="http://news.ycombinator.com/item?id=2429411">making the rounds</a> on the internet again, six months after I delivered it at JSConf.eu in Berlin, and this time around, a colleague on IRC shared a link with me that drew from it: <a href="http://www.dagolden.com/index.php/1446/is-javascript-the-new-perl/">Is JavaScript the New Perl?</a></p>

<p>Perl has a special place in my heart; it&#8217;s the first language I used to solve a real-world problem, and I still have the second edition Learning Perl that my good friend Marcus got for me at the time. These days I struggle for it not to look mostly like a lot of gibberish, but in the late 1990s it was funtimes.</p>

<p>Anyway. The post that linked to my presentation asked if JavaScript might be going through some of the same pains that Perl has gone through, and linked to an eerily relevant presentation about Modern Perl, a movement &#8220;actively seeks to both to teach how to write good code and change perceptions of Perl that still linger from the dot.com 90s.&#8221; It talks about the void that Perl sought to fill way back in 1987, and then steps through the highs and lows of the intervening 23 years.</p>

<p>One thing that struck me, reading the slides, is that Perl &#8211; like other open-source, server-side languages &#8211; has the distinct benefit of being community-driven. While, yes, JavaScript has a wonderful and vibrant community, the language itself is held hostage by browser vendors, some of whom have shown a strong inclination to not give a fuck about owning up to and fixing their egregious mistakes. Using new features of a language like Perl is, at the end of the day, a largely internal problem &#8211; given enough time and money, switching to a new version of the language that offers new features for code organization, testing, and abstraction is a thing a project can do. Indeed, Perl as a community can even make bold decisions like deciding that a new version simply won&#8217;t be back-compat with a version that came before, throwing away ideas that turned out to be duds; meanwhile, JavaScript web developers often must bend over backwards to ensure back-compat with decade-old technology, and the only way to transition away from that technology is to give up on a set of users entirely.</p>

<p>We&#8217;ve already seen what this means for JavaScript as a language: it was years after JavaScript&#8217;s debut before we really started seeing <a href="http://www.yuiblog.com/blog/2007/06/12/module-pattern/">conversations</a> about what a module should look like in JavaScript, and <a href="http://tagneto.blogspot.com/2011/04/on-inventing-js-module-formats-and.html">we&#8217;re still fighting over it</a> today. Without a solid dependency management system &#8211; something you can take for granted in any 15-year-old community-driven language &#8211; dependency management often means sticking another script tag on the page, and even the most popular JavaScript library on the planet <a href="http://bugs.jquery.com/ticket/7102">struggles</a> with how to participate in a fledgling ecosystem. With no arbiter of common, tested, community-approved, community-vetted solutions &#8211; see Perl&#8217;s CPAN &#8211; it&#8217;s an environment that&#8217;s ripe for fragmentation, and shining examples of <a href="http://en.wikipedia.org/wiki/Not_Invented_Here">Not Invented Here (NIH)</a> litter the JavaScript landscape. Lacking even an agreed-upon method of expressing dependencies, the <em>findability</em> of good solutions is low, and coalescence only occurs around tools with extremely low barriers to entry and extremely high near-term reward.</p>

<p>When Marcus was teaching me Perl, back in the dot com heyday of the late 1990s and before the world temporarily went to hell for a few years, there was great emphasis on TIMTOWTDI: there is more than one way to do it. That mantra made Perl beautiful and elegant and powerful. Too often, it also made it ridiculously hard for the next developer to build upon and maintain, especially as the problems developers were solving got more complicated than copying and pasting some code to support a contact form (sound familiar?). In the end, that mantra meant Perl&#8217;s reputation suffered, as the consequences of code written by developers with a whole lot of freedom and not so much skill became clear.</p>

<p>This, in a nutshell, is what I was talking about in Berlin: that the reputation of this language we love stands to suffer if we don&#8217;t get around to working together to solve these larger problems, and educating the wider world of JavaScript developers as we figure it out. Unlike with Perl, the language itself isn&#8217;t going to evolve in time to help us here &#8211; unless and until we&#8217;re willing to give up on huge swaths of users, we will, generously, be <a href="http://infrequently.org/2010/09/but-ie-9-is-just-around-the-corner/">stuck with the browser technology of 2009</a> for a long time to come. Unlike the Modern Perl movement, <strong>the patterns and tools and practices that will form the foundation of Modern JavaScript are going to have to come from outside implementations of the language itself</strong>.</p>

<p>Realizing that, it becomes clear just how imperative it is that we, as a community, figure out dependency management, modularization, and intentional interoperability so that these patterns, tools, and practices can start to emerge organically. James Burke, the creator of <a href="http://requirejs.org/">RequireJS</a>, is something of a hero to me, not for creating RequireJS, but for taking on the challenge of interacting calmly and level-headedly with all sorts of stakeholders to try to make <a href="http://wiki.commonjs.org/wiki/Modules/AsynchronousDefinition">AMD modules</a> a viable reality. Tool and library developers need to stop debating whether this is a good idea and get to work on making it happen.</p>

<p>Tools and libraries also need to take seriously the need for modularization &#8211; though I confess I have many misgivings about the NIH aspect of Dustin Diaz&#8217;s <a href="https://github.com/ender-js/Ender">Ender.js</a>, and wish that the considerable effort involved had been directed toward an established project with similar features, I can&#8217;t help but hope it will pressure libraries like jQuery to make more efforts in the direction of modularization.</p>

<p>An equally important aspect of modularization is ensuring minimal duplication of effort. As a community, we need to agree on a core set of functionality that ought to be provided by the language but isn&#8217;t, and implement that itself as an interchangeable module. A page with both Underscore.js and jQuery on it has tremendous duplication of functionality, for example. Interchangeability will allow end users to roll exactly the tool they need, no more and no less. Eventually, standard toolkits could emerge that draw on the best of all worlds, rather than one-size-fits-all tools that exist in isolation.</p>

<p>While I agree with what Tom Dale wrote in his oddly controversial post &#8211; that <a href="http://tomdale.net/2011/04/imagine-a-beowulf-cluster-of-javascript-frameworks/">&#8220;unless it is designed to work well together, it usually won&rsquo;t&#8221;</a> &#8211; the more I think about it, the more I realize that the problem lies in our current inability to reliably isolate functionality and express dependencies across tools. It&#8217;s not that large tools like Dojo are the One True Way &#8211; it&#8217;s that large tools like Dojo are incredibly powerful precisely because they take seriously the need for a lightweight core leveraged by components that deliver specific, isolated functionality. JavaScript as a whole will become more powerful by embracing the pattern.</p>

<p>The political problems here are obvious and several: such modularization will, by definition, lead to winners and losers; the identities of libraries as we know them stand to be diluted if it becomes trivial to use only parts of them. The emphasis will shift to curated toolkits that assemble best-of-breed solutions, and NIH efforts will compete on merit, not marketing. At the same time, though, trying new things will no longer involve learning a whole new set of tools, and developers won&#8217;t be as stuck with a solution that made sense once upon a time but not anymore.</p>

<p>A final and important piece of the puzzle is actually educating people about the patterns that are enabled when we embrace these tools and practices. The wider community of everyday devs who are just trying to get their job done has hopefully graduated from copying and pasting scripts, but there&#8217;s a long path ahead, and part of the work of Modern JavaScript needs to be clearing that path for them.</p>

<p>I said it in my Berlin talk, and I will say it again: <em>sharing what we know is as important as making new things</em>, even if it&#8217;s not always quite as fun. All the script loaders, build tools, inheritance systems, array utilities, templating frameworks, and data abstractions in the world are meaningless if we don&#8217;t help people understand how and why to use them.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A Dojo Boilerplate]]></title>
    <link href="http://rmurphey.com/blog/2011/04/04/a-dojo-boilerplate/"/>
    <updated>2011-04-04T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/04/04/a-dojo-boilerplate</id>
    <content type="html"><![CDATA[<p>When I first started playing with the <a href="http://dojotoolkit.org">Dojo Toolkit</a>, it was easy enough to <a href="http://dojotoolkit.org/documentation/tutorials/1.6/hello_dojo/">use the CDN-hosted <code>dojo.js</code> and get started</a>, but before long I wanted to make use of one of the features that drew me to Dojo in the first place: the build system that parses your code&rsquo;s dependencies as expressed by <code>dojo.require()</code> statements and creates production-ready files.</p>


<p>Coming from a world where this was entirely a DIY affair, the patterns I should follow for taking advantage of Dojo&rsquo;s system were, shall we say, less than clear. There was a lot of frustration, a lot of swearing, and a lot of pleas for help in #dojo on Freenode.</p>


<p>These days, I&rsquo;m talking about Dojo a lot, and I&rsquo;ve gotten pretty comfortable with how to set up a project &mdash; I even wrote a post about <a href="http://blog.rebeccamurphey.com/scaffolding-a-buildable-dojo-application">scaffolding a Dojo app</a> once I felt like I had the basics down &mdash; but for a long time I&rsquo;ve wanted to release a ready-made starter project, rather than making people follow seven lengthy steps.</p>


<p>With the help of <a href="http://zetafleet.com">Colin Snover</a>, I&rsquo;m pleased to release the <a href="https://github.com/csnover/dojo-boilerplate">Dojo Boilerplate</a>, a simple starter project if you&rsquo;d like to get your feet wet with Dojo and the power of its dependency management and build system. It comes with a bare-bones do-nothing app, a shell script for downloading the Dojo SDK and getting it in the right place, and a shell script and profile file for actually creating a built version. For the brave, it also includes a work-in-progress router for single-page apps &mdash; one of the few features that I feel Dojo itself is missing. Everything you should need to know is documented in the README.</p>


<p>I&rsquo;ve also created a <a href="https://github.com/rmurphey/dojo-demo">small demo app</a> that uses the boilerplate and shows some of the basic concepts of MVC development using Dojo, including separating your code into models, views, controllers, and third-party services. It includes an example of templated widgets, which are one of the biggest selling points of Dojo for me, as well as an uber-basic example of object stores, new in Dojo 1.6.</p>


<p>The goal of the boilerplate and the demo app is to eliminate some of that pain and WTF that I went through &mdash; while Dojo is ridiculously powerful, the barrier to entry can seem daunting. Over and over again, though, I am grateful that I took the time to overcome it.</p>


<p>Finally: as always, pull requests and issues are welcome. Enjoy.</p>


<p>Update: Colin is now the maintainer of the boilerplate; I&#8217;ve updated the links above accordingly.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[When you're building a non-trivial JS application ...]]></title>
    <link href="http://rmurphey.com/blog/2011/03/30/when-you-re-building-a-non-trivial-js-application/"/>
    <updated>2011-03-30T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/03/30/when-you-re-building-a-non-trivial-js-application</id>
    <content type="html"><![CDATA[<p>I sense another round of discussion of this is <a href="http://twitter.com/slightlylate/status/52924409509445632">about to begin</a>, and 140 characters isn&#8217;t quite enough to say what I want to say, so:</p>


<p>When you&#8217;re building a non-trivial JS application, you don&#8217;t want a jQuery developer, or a Dojo developer, or a YUI developer, or, frankly, any developer who chooses their tool before they evaluate the problem. <strong>For god&#8217;s sake, you want a JavaScript developer.</strong> Can you roll your own solution with jQuery as the base? Yes! Should you? I don&#8217;t think so, and I advise my clients against it for reasons I&#8217;ve <a href="http://blog.rebeccamurphey.com/on-rolling-your-own">written about</a> <a href="http://blog.rebeccamurphey.com/on-jquery-large-applications">at length</a>, but I&#8217;m open to hearing compelling, articulate, fact-based arguments in favor of it!</p>


<p>But do me a favor, OK? Don&#8217;t base your arguments solely on the winner of a popularity contest. Don&#8217;t tell me how easy it is to find developers familiar with one library or another, because I&#8217;ll come right back and ask you just how good those developers will be at solving problems that aren&#8217;t addressed by said library. And please tell me you&#8217;ve at least explored some of the other options besides [insert the library you&#8217;re advocating here].&nbsp;</p>


<p>People read what I write about JavaScript libraries and they write me heartfelt tweets and e-mails saying OMG YOU HATE JQUERY NOW WHAT HAPPENEDDDDD? I don&#8217;t hate jQuery! It is a perfectly viable and valuable tool for so many things! But when people argue not just its viability but its absolute <em>supremacy</em>, when people get defensive and possibly even angry that I suggest there are solutions that are vastly better suited to a certain set of problems, when people contort themselves into pretzels to make their case and their case is &#8220;well, it&#8217;s not <em>that</em> bad&#8221; &#8230; well, that smacks of blind loyalty, not a thoughtful weighing of the tradeoffs and challenges we face as developers, and I question how those people would fare if actually confronted with the needs of a non-trivial application.&nbsp;</p>


<p>So, please: Tell me what solutions you&#8217;ve looked at for non-trivial application development. Tell me where they work, tell me where they fall short. Tell me what you&#8217;re working on and how you chose the tools. Don&#8217;t tell me why I&#8217;m wrong &#8211; tell me why you&#8217;re right. Deal? Discuss.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Future of jQuery Fundamentals (and a confession)]]></title>
    <link href="http://rmurphey.com/blog/2011/03/17/the-future-of-jquery-fundamentals-and-a-confession/"/>
    <updated>2011-03-17T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2011/03/17/the-future-of-jquery-fundamentals-and-a-confession</id>
    <content type="html"><![CDATA[<p>About 9 months ago, <a href="http://blog.rebeccamurphey.com/2010/06/17/open-source-jquery-training">I released</a> <a href="http://jqfundamentals.com/book/">jQuery Fundamentals</a>, a free, online training curriculum for people interested in learning jQuery based on material I&rsquo;d assembled while leading jQuery trainings.</p>




<p>The response was and has continued to be amazing: not only has the book seen hundreds of thousands of visits, but it has also received content contributions and bug reports from dozens of people. It has become something of a collaborative work, and one of the go-to resources for jQuery and beginning JavaScript learning. It has been used to teach classes internally at companies and at colleges and universities, and it&rsquo;s been translated into multiple languages. It&rsquo;s even made me a tad bit of money &mdash; I recently granted a license to Webucator to create derivative works for their <a href="http://www.webucator.com/webdesign/jquery.cfm">jQuery class</a> &mdash; and landed me near the top of Google&rsquo;s search results for &ldquo;jQuery training&rdquo;.</p>




<p>And so here is where we get to the confession part: while I&rsquo;ve stayed very much in touch with the evolution of jQuery these last couple of years, written gobs of sample code in efforts to make people better at using the library, and even played a bit of a role in some of the new features in jQuery 1.5, the last time I chose the library for a project was in the fall of 2008. The last time I used it on a project at all was in the summer of 2010, and in a matter of a few weeks I was gutting the fragile, bug-ridden, DOM-centric code and re-writing the single-page application with &mdash; wait for it! &mdash; Dojo. jQuery and I have gone from being in a committed relationship to seeing other people to pretty much just saying hi on Facebook now and again.</p>




<p>This has put me in a strange place with jQuery Fundamentals &mdash; I want to be investing my energy supporting projects that I <em>use</em>, and while I can still write jQuery just fine and stay in touch with what&rsquo;s going on with it, I really don&rsquo;t &hellip; <em>use</em> it. That&rsquo;s made it increasingly difficult to continue maintaining jQuery Fundamentals as a resource for the jQuery community.</p>




<h2>Burying the Lede</h2>




<p>At the jQuery conference in Boston last fall, John Resig invited me to participate in a conversation about an effort by the project to create a learning resource for the community, and through the course of that and future conversations, jQuery Fundamentals has found its new home.</p>




<p>I&rsquo;ve been working actively with jQuery team member (and <a href="http://yayquery.com">yayQuery</a> co-host) Adam J. Sontag and community member Dan Heberden to get the book into good shape as it transitions to being &ldquo;owned&rdquo; by the jQuery project. I&rsquo;ve also donated a third of the proceeds of the Webucator licensing arrangement to the jQuery project, to recognize the contributions of the community and to give even a wee bit of financial support to the learning efforts.</p>




<p>Adam, Dan, and I will be working hard to address some of the <a href="https://github.com/rmurphey/jqfundamentals/issues">open issues</a> with the book in the coming weeks. If you&rsquo;re interested in helping, drop me an email, hit me up on Twitter, or just submit a pull request (though you may want to talk to us first if the solution to an issue isn&rsquo;t straightforward). From formatting fixes to writing new content to updating the book to reflect the changes in jQuery 1.5, there&rsquo;s a lot to be done.</p>




<h2>What&rsquo;s Next?</h2>




<p>These days I&rsquo;m working with a fantastic client doing mobile application development with PhoneGap and Dojo. It&rsquo;s pretty much the most challenging, engaging, rewarding project I&rsquo;ve had an opportunity to work on in nearly three years of independent consulting. These days, when I get the very inquiries I hoped to get by releasing jQuery Fundamentals in the first place, I direct people to the excellent folks at <a href="http://bocoup.com">Bocoup</a>. Slowly, I&rsquo;m recalibrating my efforts and attention toward the projects that make my day-to-day development life better. As soon as I feel like jQuery Fundamentals is in a good place where I don&rsquo;t have to worry about its future, you can expect to see a lot more learning-related content coming from me again; just, this time, it probably won&rsquo;t be about jQuery.</p>




<p>I hope you&rsquo;ll stick around.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Deferreds coming to jQuery 1.5?]]></title>
    <link href="http://rmurphey.com/blog/2010/12/25/deferreds-coming-to-jquery/"/>
    <updated>2010-12-25T00:00:00-05:00</updated>
    <id>http://rmurphey.com/blog/2010/12/25/deferreds-coming-to-jquery</id>
    <content type="html"><![CDATA[<p><em>I have updated this post to show the code using the API that was released in jQuery 1.5.0.</em></p>

<p>A few weeks ago, a <a href="https://github.com/jquery/jquery/commit/ab3ba4a81252c4357a7aab5f24d765d41d47986e">major rewrite of jQuery&#8217;s Ajax functionality</a>
landed in the jQuery GitHub repo. Thanks to <a href="http://www.jaubourg.net/">Julian Aubourg</a>, jQuery looks like it will get a feature
that I&#8217;ve desperately wished it had ever since I started spending time with
Dojo:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">doAjax</span><span class="p">(</span><span class="nx">debug</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">url</span> <span class="o">:</span> <span class="s1">&#39;foo.php&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">dataType</span> <span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">success</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">resp</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">debug</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">req</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;let&#39;s see that again!&quot;</span><span class="p">,</span> <span class="nx">resp</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// return the request object so other</span>
</span><span class='line'>  <span class="c1">// things can bind to it too!</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">req</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">doAjax</span><span class="p">().</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">){</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Once more, with feeling!&quot;</span><span class="p">,</span> <span class="nx">resp</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Starting with 1.5 (I&#8217;m guessing), users will be able to easily attach callbacks
to XHRs &#8230; later! And pass around the return value of <code>$.ajax</code> as an actually
useful object with a familiar API, rather than just getting back the native
XHR! No longer will we have to bundle up callback functionality &#8211; some of
which might be optional, or depend on other code &#8211; inside our success or error
callbacks. So hott.</p>

<p>When I heard that these Ajax changes had landed, I got to thinking about how
Dojo provides its ability to belatedly attach success and error handlers to its
XHRs: underlying its XHR methods is
<a href="http://dojotoolkit.org/reference-guide/dojo/Deferred.html#dojo-deferred">dojo.Deferred</a>.
It <strong>allows users to assign callback functions for success and error conditions
for a task that may not complete immediately.</strong> Dojo makes use of this for its
XHR stuff, but it&#8217;s incredibly useful generically, too:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">doSomethingAsync</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">dfd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
</span><span class='line'>  <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">dfd</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span> <span class="mi">5000</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">dfd</span><span class="p">.</span><span class="nx">promise</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">doSomethingAsync</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">resp</span><span class="p">);</span> <span class="c1">// logs &#39;hello world&#39;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, Dojo provided the late callback functionality via deferreds. jQuery now had
late callback functionality. Was the deferred functionality hidden in the
jQuery Ajax rewrite, waiting to be exposed? Julian and I and several others got
to talking in the jQuery development IRC channel, and decided it seemed like an
interesting and viable idea. A few days later, Julian&#8217;s <a href="https://github.com/jquery/jquery/commit/116c82b027a03a7a5670fa580fa9af819cc1cc03">first draft of jQuery.Deferred</a>
landed in a branch on GitHub.</p>

<p>It&#8217;s early days, but there have been a lot of good discussions already about
the proposed API and how it should work. Through all of the conversations I&#8217;ve
been part of, it&#8217;s become really clear that no one cares about deferreds until
you show them what they actually mean: the ability to register an interest in
the outcome of arbitrary asynchronous behavior, <em>even if the outcome has
already occurred</em>. Even better, you can register your interest in the outcome
of behavior that <em>may or may not be asynchronous</em>.</p>

<p>I assure you that once you have experienced this, you will wonder how you lived
without it.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">cache</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">doSomethingMaybeAsync</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">cache</span><span class="p">[</span><span class="nx">val</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">val</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">url</span> <span class="o">:</span> <span class="s1">&#39;foo.php&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">data</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">value</span> <span class="o">:</span> <span class="nx">val</span> <span class="p">},</span>
</span><span class='line'>    <span class="nx">dataType</span> <span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">success</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">cache</span><span class="p">[</span><span class="nx">val</span><span class="p">]</span> <span class="o">=</span> <span class="nx">resp</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="nx">doSomethingMaybeAsync</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">))</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">){</span>
</span><span class='line'>    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;The value for foo is&quot;</span><span class="p">,</span> <span class="nx">resp</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&#8217;ll also be possible to do something like you see below. I&#8217;m not sure what
the exact API will be for creating a generic deferred instance, but I hope it
will be something along these lines:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">doIt</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">dfd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">$</span><span class="p">.</span><span class="nx">Deferred</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">dfd</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span> <span class="mi">5000</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">dfd</span><span class="p">.</span><span class="nx">promise</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">doIt</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">resp</span><span class="p">);</span> <span class="p">},</span> <span class="nx">errorFn</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>These changes are sitting in a <a href="https://github.com/jquery/jquery/tree/deferred">branch in the jQuery GitHub repo</a> as we speak, and I think
it&#8217;s likely we&#8217;ll see them move to master sooner than later. It&#8217;s a nice story
of collaboration and community participation that helped make something good &#8211;
the Ajax rewrite &#8211; even better.</p>

<p>It&#8217;s exciting to see jQuery venture a bit more into the abstract. My
experiences with Dojo core so far make me think there are probably more
opportunities for these sorts of utilities that would be of high value for
a substantial number of jQuery users. On the other hand, one of the constant
themes of our conversations about deferreds has been the potential for
confusion with the new methods. Will the API look familiar and jQuery-like, or
will users be confused about the ability to chain methods on something other
than a jQuery selection? Are there bigger-picture considerations when it comes
to adding new constructors to the jQuery namespace? It&#8217;ll be interesting to see
how these questions sort themselves out, especially if other similar features
appear that don&#8217;t fall neatly under the well-established
DOM/Ajax/Events/Effects umbrella.</p>

<p>The <a href="https://github.com/jquery/jquery/commits/deferred">conversation&#8217;s happening on GitHub</a> &#8211; I hope you&#8217;ll
join in.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[On Conferencing]]></title>
    <link href="http://rmurphey.com/blog/2010/11/20/on-conferencing/"/>
    <updated>2010-11-20T00:00:00-05:00</updated>
    <id>http://rmurphey.com/blog/2010/11/20/on-conferencing</id>
    <content type="html"><![CDATA[<p>I&#8217;m a few hours away from finalizing my slides for the Rich Web Experience in Ft. Lauderdale next month. I&#8217;ll be presenting on basic tips for refactoring your jQuery; I think it&#8217;s a decent presentation &#8211; the part of it I&#8217;ve finished, anyway &#8211; and I&#8217;ll be glad to have it in my collection.</p>

<p>By my count, RWX will be the 15th conference or non-trivial event I attend in 2010, including two that I&#8217;ve organized and eight that I&#8217;ve spoken at:</p>

<h2>Organizer</h2>

<ul>
<li><a href="http://texasjavascript.com">TXJS</a> (Austin, TX)</li>
<li>NCJS (Durham, NC)</li>
</ul>


<h2>Speaker</h2>

<ul>
<li>JSConf EU (Berlin, Germany; &#8221;<a href="http://www.slideshare.net/rmurphey/the-jquery-divide-5287573">The jQuery Divide</a>&#8221;)</li>
<li>Boston jQuery Conference (Boston, MA; &#8221;<a href="http://www.slideshare.net/rmurphey/functionality-basedorg">Functionality Focused Code Organization</a>&#8221;)</li>
<li>jQuery Summit (Online; &#8221;<a href="http://www.slideshare.net/rmurphey/functionality-basedorg">Functionality Focused Code Organization</a>&#8221;)</li>
<li>Indieconf (Raleigh, NC; &#8221;<a href="http://www.slideshare.net/rmurphey/retooling-your-workflow">Retooling Your Workflow</a>&#8221;)</li>
<li>Refresh the Triangle (Durham, NC; &#8221;<a href="http://www.slideshare.net/rmurphey/delivering-a-responsive-ui">Delivering a Responsive UI</a>&#8221;)</li>
<li>Triangle JavaScript Meetup (Durham, NC; &#8221;<a href="http://www.slideshare.net/rmurphey/building-large-jquery-applications">Building Large jQuery Applications</a>&#8221;)</li>
<li>Rich Web Experience (Ft. Lauderdale, FL; &#8220;Cleaner, Leaner, Meaner: Refactoring Your jQuery&#8221;)</li>
<li>Durham Developer Day (Durham, NC; &#8221;<a href="http://www.slideshare.net/rmurphey/dojo-confessions">Dojo Confessions</a>&#8221;)</li>
</ul>


<h2>Attendee</h2>

<ul>
<li>SXSW (Austin, TX)</li>
<li>Bay Area jQuery Conference (Mountain View, CA)</li>
<li>JSConf US (Washington, DC)</li>
<li>CouchCamp (Walker Creek Ranch, CA)</li>
<li>Dojo Developer Days (Mountain View, CA)</li>
</ul>


<p>(For what it&#8217;s worth, and because I was curious enough to count: I&#8217;ve also participated in 11 episodes of <a href="http://yayquery.com">yayQuery</a>, written a half-dozen in-depth blog posts, organized at least six local web women meetups, and published an open <a href="http://jqfundamentals.com/book/book.html">jQuery training curriculum</a>.)</p>

<p>It was sometime in early 2009 that I decided to make a point of speaking at more events. I&#8217;d always enjoyed the challenge and the thrill of public speaking, but I also wanted to be part of the solution to the dearth of women speakers in JavaScript land. Something like 18 months later, it seems I might be sort of good at it, if my SpeakerRate is to be believed. This fall I found myself actually turning down requests to speak.</p>

<p>It turns out that they forgot to remind me in work-for-yourself school that at the end of the day or week or month, I&#8217;ve still gotta make some money now and then. Putting together presentations and traveling to conferences and meeting the expectations that come along with being a Vaguely Important Person &#8230; it&#8217;s fucking hard work, and when there&#8217;s no company to pay you for it, it&#8217;s also fucking expensive, even if it theoretically brings in work in the long run. While every non-local event I spoke at paid for my hotel and accommodations, I was not otherwise compensated. The events that I organized ended up being pretty much a wash, financially.</p>

<p>I spent untold hundreds of hours &#8211; I&#8217;m not making that up &#8211; preparing presentations, traveling to conferences, and speaking this year. Looking back at my calendar since late August, when all of this got really and truly insane (most of my speaking has happened since then), the sad size of my business bank account makes stunning sense. We&#8217;ll leave aside the toll that working all the time and then being gone all the rest of the time takes on one&#8217;s home life, but suffice to say that the toll is, also, not trivial.</p>

<p>Over the last few weeks, it&#8217;s become pretty clear that I need to take a break. I&#8217;m mostly over pre-talk jitters, but these days I find myself thinking &#8220;for the love of all that&#8217;s good, do I really have to get on a plane again?&#8221; People ask me about 2011 events and I find myself on the verge of losing my shit, which really isn&#8217;t fair to anyone. People tell me how they want to be invited to speak at stuff like I am, and I let loose a heavy sigh. People come up to me at events or email me randomly because they think that I&#8217;m an &#8220;expert&#8221; on this thing or that, and can they just ask me a little question? &#8211; and I wonder what, exactly, I have wrought with all of this effort. Worst of all: potential clients ask me about taking on lucrative work, and I must tell them: &#8220;Not now, I can&#8217;t, I&#8217;m sorry. I&#8217;ve got this presentation to prepare &#8230;&#8221;</p>

<p>I might be a terrible person entirely too full of herself, or a drama queen, or whatever else you want to think. You might be certain that if I&#8217;d just think about it, there would be lots of efficiencies I could realize, and really I just make this harder than it is. That&#8217;s OK, and you might be right.</p>

<p>I want to be clear that I realize that two years ago I was nobody, and to the extent that I am anybody now, it is largely because I have been afforded so many opportunities to make a name for myself. I am grateful for them. It becomes clear, though, that I&#8217;ve let the pendulum swing way too far.</p>

<p>And so as I sit here, about to finish off the last slides of the year, I fantasize about deleting Keynote from my computer. But I also find myself thinking how I&#8217;m deciding not to do this thing that I&#8217;m kind of good at because I simply can&#8217;t afford to, and it makes me sad. It kills me to think about missing out on that warm fuzzy it-was-all-worth-it moment when everyone claps at the end. And more than anything, I feel like walking away, for however long, means yet one less woman on stage in a field that is desperate for them, and that makes me saddest of all.</p>

<p>There is no point to this post, really, except for me to get some of my thoughts out of my head and for you to know where I&#8217;ve gone if you don&#8217;t see or hear from me as much. It is, alas, time for me to actually do some of that work that all this effort has brought in. We&#8217;ll see when I emerge &#8211; maybe I will feel rejuvenated in the new year, who knows! &#8211; and whenever that is, I hope to see you there.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[jQuery Conference Breakout Session: Women & Conferences]]></title>
    <link href="http://rmurphey.com/blog/2010/10/19/jquery-breakout-women-and-conferences/"/>
    <updated>2010-10-19T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2010/10/19/jquery-breakout-women-and-conferences</id>
    <content type="html"><![CDATA[<p>I decided to organize a breakout session about women and conferences at the
<a href="http://events.jquery.org/2010/boston/">jQuery Conference in Boston</a> this past
weekend, and I couldn&#8217;t be happier about how it went &#8211; it was probably one of
the more productive sessions of its sort that I&#8217;ve participated in.</p>

<p>My best guess, with the help of some t-shirt size numbers from the most-amazing
<a href="http://twitter.com/#!/wifelette">Leah Silber</a>, is that the conference
attendees were about 10% women. This sounds a bit terrible, but on the
contrary, looking around the room, I felt like women were in fact more
represented than I&#8217;m accustomed to at other JavaScript-centric conferences.</p>

<p>In setting up the breakout session, I wanted to do two things: one, applaud the
women who did show up, because they are already part of the solution; two, (at
the risk of sounding a bit lame), call upon them to be the change that so many
of us want to see at tech conferences.</p>

<p>I started the session with a small intro/lecture/rant: when we have these
conversations, we&#8217;re talking about a conference for an open-source project, and
this means that we &#8211; community members &#8211; need to take some ownership of the
problem if we want to see more diversity on stage; it shouldn&#8217;t just be up to
the project or the conference organizers. I&#8217;ve talked to plenty of jQuery team
members, and the problem is certainly not that they are seeking to exclude
non-white-male speakers, nor that they are insensitive to the issue; to the
contrary, they are incredibly interested in diversifying their lineup, but
they&#8217;re somewhat at a loss as to where to find people who would be good
speakers. My call to action to the people in attendance was to be part of the
solution.</p>

<p>My favorite part about the session was that it didn&#8217;t turn into a big bitchfest
&#8211; I think there was actually some productive discussion that took place. While
the attendees were mostly women, there was a solid contingent of men. Menno van
Slooten, in particular, was great &#8211; he talked about his experience as a
relative outsider whose boss pressured him into submitting a talk to the Bay
Area jQuery Conference earlier this year. His talk at that conference ended up
being so well received that he was back to speak in Boston.</p>

<p>At some point during the session, I realized that John Resig was sitting across
from me. I don&#8217;t want sound like a giddy schoolgirl here &#8211; John&#8217;s just a
person, and I don&#8217;t want to sound like he graced us with his benevolent
presence &#8211; but I can&#8217;t tell you how much I think it changed the dynamic of the
discussion to know that it was being heard by such an influential
representative. John answered questions directly and honestly, and there was a
serious sense that he was hearing feedback too &#8211; we weren&#8217;t just talking
amongst ourselves. His presence dispelled any sense that the project wasn&#8217;t
interested in the topic; I&#8217;d encourage other prominent people who care about
these things to make time to take part in similar conversations.</p>

<p>I was kind of amazed to hear how simple the questions were about speaking at a
jQuery conference. I have given great credence to issues of anxiety, shyness,
and perceived inadequacy &#8211; and I don&#8217;t think these issues have gone away &#8211;
but it never occurred to me that people had really basic questions about the
process of speaking at a conference. This was actually sort of great &#8211; while I
can&#8217;t singlehandedly get a potential speaker to overcome a sense of anxiety or
inadequacy, there were so many questions that could be answered simply and
directly.</p>

<p>To that end, I&#8217;m working on a FAQ for potential speakers at future jQuery
conferences, addressing basic questions about process, etc., that I hope the
project will incorporate into future calls for speakers. As a decently
connected member of the jQuery community, I know who to ask when I have these
questions, but I naively didn&#8217;t realize how inaccessible the answers could seem
to &#8220;outsiders.&#8221; Explaining the answers to basic questions is the sort of easy
but meaningful effort that a conference can make to lower the barriers to new
speakers, women or men. This should be a no-brainer for any conference that
wants to its lineup to be interesting,  fresh, and diverse.</p>

<p>Another idea that we talked about was pairing accepted speakers up with a buddy
of sorts. I have tried to be this buddy, informally, to people who are speaking
for the first time, but I think it could be worthwhile to formalize the
process. New speakers could ask their &#8220;buddy&#8221; questions about what it&#8217;s like to
speak, how to prepare, what to expect from the audience, etc. The speaker would
be more prepared and comfortable, and the audience would get a better
presentation.</p>

<p>There was a tremendous lack of clarity surrounding what&#8217;s actually involved in
submitting a talk to a conference. While I&#8217;m by no means a grizzled veteran of
the conference circuit &#8211; my first major talk was just a year ago &#8211; my
experience so far is that submitting a talk is mostly about having a
well-articulated idea and some semblance of evidence that you can pull it off.
This, perhaps, is where the process becomes most subjective and biased toward
&#8220;insiders&#8221; &#8211; people known to give good talks are likely to get the opportunity
to give talks again &#8211; but I think there&#8217;s plenty of room to overcome any bias.
People who have made a point of participating in the community, people who have
made a point of contributing useful content about their chosen topic, will
generally get the benefit of the doubt. Reaching out to a past speaker, or to
an established community member, can be a great help in shepherding your talk
through the process. Again, I&#8217;m hoping that the FAQ can address some of this
low-hanging fruit.</p>

<p>Regarding jQuery conferences in particular, John made the very good point that
there is a lot of room for talks that aren&#8217;t specifically about jQuery. There
were actually lots of these sorts of talks at the conference this weekend &#8211;
talks about TDD, HTML5, object-oriented CSS, CouchDB, and more. One of the
lovely things about the jQuery and JavaScript community is that community
members have a potentially wide area of interest &#8211; any topic related to
front-end development is likely to be relevant to the audience. John pointed
out that talks about these tangential topics may be one of the greatest
opportunities for newcomers to the world of speaking: the speaker is likely to
be the only one presenting on the topic, and can potentially establish
themselves as something of a subject matter expert on the topic.</p>

<p>Again, this was one of the more productive conversations I&#8217;ve participated in
on this topic. If you&#8217;d like to talk to me about it more, don&#8217;t hesitate to
drop me an email or a tweet or a comment. If you&#8217;re considering venturing into
the speaking world, I&#8217;m happy to talk with you about that too. Thanks to
everyone who came, and especially to <a href="http://twitter.com/#!/unruthless">Ruthie BenDor</a> for her support, and I look forward
to continued discussion.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Functionality-Focused Code Organization]]></title>
    <link href="http://rmurphey.com/blog/2010/10/17/functionality-focused-code-organization/"/>
    <updated>2010-10-17T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2010/10/17/functionality-focused-code-organization</id>
    <content type="html"><![CDATA[<p>I spoke yesterday at the 2010 Boston jQuery Conference about
&#8220;Functionality-Focused Code Organization.&#8221; It was a presentation that
summarized a year of thinking about organizing JavaScript applications, and I
think it went fairly well. It was a treat to see so many people nodding in
understanding and agreement out in the audience, and to talk to people
afterwards who have thought about and struggled with these same problems.</p>

<ul>
<li><a href="http://www.slideshare.net/rmurphey/functionality-basedorg">Slides</a> (Note
that you can download a PDF there if you&#8217;d prefer not to view the slides on
SlideShare)</li>
</ul>


<p>I had one person come up to me afterwards who really left an impression &#8211; I
don&#8217;t recall his name (I am perfectly terrible with names), but what he said
was that he came from a background of developing desktop applications, and that
the concepts I talked about in fact made perfect sense to him. I think this is
important to remember &#8211; the ideas that I talked about aren&#8217;t new or novel at
all, but really just long-established patterns of developing applications,
adapted to fit in the world of JavaScript and the browser. I don&#8217;t come from a
CS background at all &#8211; I came to this whole JavaScript thing via HTML and CSS,
with a tiny smattering of programming mixed in &#8211; and so I&#8217;ve arrived at a lot
of this things the hard way. It&#8217;s gratifying to hear people tell me I&#8217;ve gotten
it right, and if anything, it makes me want to get the word out to all the
people who are in the same shoes as I was not that long ago.</p>

<p>Finally: A big thanks to the jQuery team, and especially Leah Silber, for
putting on the conference. I know it&#8217;s hard work, and I know there were some
bumps (there always are!), but as a speaker, I feel like I&#8217;ve been treated very
well, which means a lot. Thanks, guys.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[In Search of JavaScript Developers: A Gist]]></title>
    <link href="http://rmurphey.com/blog/2010/09/15/in-search-of-javascript-developers-a-gist/"/>
    <updated>2010-09-15T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2010/09/15/in-search-of-javascript-developers-a-gist</id>
    <content type="html"><![CDATA[<p>I posted a <a href="http://gist.github.com/576723">gist</a> the other day in an attempt to locate some JavaScript help. I&rsquo;m finding, lately, that I&rsquo;m being asked to do more work than I can comfortably take on without having some overflow capacity, but I&rsquo;ve been a little lax at actually identifying people who can provide that capacity up until now. That meant I was turning down work, and that&rsquo;s not a good thing.</p>




<p>I had a great time the last couple of days watching people come up with solutions, and was especially gratified that so many people who weren&rsquo;t looking for work thought that answering JavaScript questions sounded like fun.</p>




<p>A lot of people have asked if I&rsquo;d be providing &ldquo;answers&rdquo; to the questions I posed in the gist, so I wanted to try to do that, mixed in with a bit of commentary about what I was looking for.</p>




<h2>Question 1: Writing Readable but Terse Code</h2>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 1: how could you rewrite the following to make it shorter?</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">foo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">bar</span><span class="p">.</span><span class="nx">doSomething</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">bar</span><span class="p">.</span><span class="nx">doSomethingElse</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>Answers to this question told me whether to keep reading; I was looking for something like:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">bar</span><span class="p">[</span><span class="nx">foo</span> <span class="o">?</span> <span class="s1">&#39;doSomething&#39;</span> <span class="o">:</span> <span class="s1">&#39;doSomethingElse&#39;</span><span class="p">](</span><span class="nx">el</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// OR</span>
</span><span class='line'>
</span><span class='line'><span class="nx">bar</span><span class="p">[</span><span class="s1">&#39;doSomething&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">foo</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="s1">&#39;Else&#39;</span><span class="p">)](</span><span class="nx">el</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>




<p>To be honest, the second one is maybe a little too clever. But generally, I wanted to see submissions that understood using the ternary operator instead of an if statement to create shorter but still-readable code when all that is different is a method name.</p>




<p>Some people submitted an answer that used a ternary operator, but didn&rsquo;t take advantage of it to just switch the method name:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">foo</span> <span class="o">?</span> <span class="nx">bar</span><span class="p">.</span><span class="nx">doSomething</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bar</span><span class="p">.</span><span class="nx">doSomethingElse</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>




<p>This is an improvement, definitely, but there&rsquo;s room for more.</p>




<h2>Question 2: Understanding Variable Scope</h2>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">foo</span> <span class="o">||</span> <span class="s1">&#39;world&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span>
</span><span class='line'><span class="p">})();</span>
</span></code></pre></td></tr></table></div></figure>




<p>This was a question where, in hindsight, what I was looking for may not have been super-clear. I got a lot of right-enough answers, but really what I wanted to hear was that the <code>||</code> statement was absurd, because <code>foo</code> would always evaluate to <code>'world'</code> due to <a href="http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting">variable hoisting</a>.</p>




<p>This can be sort of a sort of crazy thing to wrap your head around, but basically JavaScript scans the contents of a function for <code>var</code> statements <em>before</em> it runs the function. Any variable initialized with a <code>var</code> statement inside the function will become local to the function, <em>even if the variable is &ldquo;used&rdquo; before it is initialized</em>. Changing the order of the two lines inside the function shows this readily:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span> <span class="c1">// undefined!</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">foo</span> <span class="o">||</span> <span class="s1">&#39;world&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">})();</span>
</span></code></pre></td></tr></table></div></figure>




<p>Some submissions thought I wanted access to the external <code>foo</code> inside the closure &mdash; not an unreasonable interpretation of the question.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">f</span> <span class="o">||</span> <span class="s1">&#39;world&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span>
</span><span class='line'><span class="p">})(</span><span class="nx">foo</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>




<p>Anyway, there were lots of right-enough answers, but anyone who talked about hoisting definitely caught my eye.</p>




<h2>Question 3: Working with Objects and Prototypes</h2>




<p>This question was looking for really basic understanding of prototypes. It also was written to be a tad hard to follow, lumping all the questions into a single paragraph, to simulate a not-atypical client request.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 3: given the following code, how would you override the value of the</span>
</span><span class='line'><span class="c1">// bar property for the variable foo without affecting the value of the</span>
</span><span class='line'><span class="c1">// bar property for the variable bim? how would you affect the value of</span>
</span><span class='line'><span class="c1">// the bar property for both foo and bim? how would you add a method to</span>
</span><span class='line'><span class="c1">// foo and bim to console.log the value of each object&#39;s bar property? how</span>
</span><span class='line'><span class="c1">// would you tell if the object&#39;s bar property had been overridden for the</span>
</span><span class='line'><span class="c1">// particular object?</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">Thinger</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Thinger</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">bar</span> <span class="o">:</span> <span class="s1">&#39;baz&#39;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Thinger</span><span class="p">(),</span>
</span><span class='line'>    <span class="nx">bim</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Thinger</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>




<p>The good submissions broke the question down into separate comments, and then showed the answers:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// override the bar prop for foo w/o affecting bim</span>
</span><span class='line'><span class="nx">foo</span><span class="p">.</span><span class="nx">bar</span> <span class="o">=</span> <span class="s1">&#39;new value&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// change the bar prop for both foo and bim</span>
</span><span class='line'><span class="c1">// (*if* it hasn&#39;t been overridden locally!)</span>
</span><span class='line'><span class="nx">Thinger</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">bar</span> <span class="o">=</span> <span class="s1">&#39;another new value&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// we could delete foo.bar now and it would get</span>
</span><span class='line'><span class="c1">// the prototype value instead</span>
</span><span class='line'><span class="c1">// delete foo.bar;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// add a method to foo and bim to log bar</span>
</span><span class='line'><span class="nx">Thinger</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">logger</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">bar</span><span class="p">);</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// check if bar has been overridden</span>
</span><span class='line'><span class="nx">foo</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span> <span class="c1">// true</span>
</span><span class='line'><span class="nx">bim</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span> <span class="c1">// false</span>
</span></code></pre></td></tr></table></div></figure>




<h2>Question 4: Iterating over Objects</h2>




<p>This one was pretty basic:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 4: given the following code, and assuming that each defined object has</span>
</span><span class='line'><span class="c1">// a &#39;destroy&#39; method, how would you destroy all of the objects contained</span>
</span><span class='line'><span class="c1">// in the myObjects object?</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">myObjects</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">thinger</span> <span class="o">:</span> <span class="k">new</span> <span class="nx">myApp</span><span class="p">.</span><span class="nx">Thinger</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">gizmo</span> <span class="o">:</span> <span class="k">new</span> <span class="nx">myApp</span><span class="p">.</span><span class="nx">Gizmo</span><span class="p">(),</span>
</span><span class='line'>  <span class="nx">widget</span> <span class="o">:</span> <span class="k">new</span> <span class="nx">myApp</span><span class="p">.</span><span class="nx">Widget</span><span class="p">()</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<p>Really I just wanted to see people iterate over an object without the use of a helper like <code>jQuery.each</code>. The <code>hasOwnProperty</code> check may seem like overkill, but I was glad when people didn&rsquo;t leave it out. Adding in the delete statement was another nice touch, though not strictly required by the question.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">obj</span> <span class="k">in</span> <span class="nx">myObjects</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">myObjects</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">myObjects</span><span class="p">[</span><span class="nx">obj</span><span class="p">].</span><span class="nx">destroy</span><span class="p">();</span>
</span><span class='line'>    <span class="k">delete</span> <span class="nx">myObjects</span><span class="p">[</span><span class="nx">obj</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<h2>Question 5: Solving Deceptively Simple Problems</h2>




<p>This question was probably the most fun, because even though it was a dead-simple task, the answers were all over the map. This was the question:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 5: given the following array, create an array that contains the</span>
</span><span class='line'><span class="c1">// contents of each array item repeated three times, with a space between</span>
</span><span class='line'><span class="c1">// each item. so, for example, if an array item is &#39;foo&#39; then the new</span>
</span><span class='line'><span class="c1">// array should contain an array item &#39;foo foo foo&#39;. (you can assume the</span>
</span><span class='line'><span class="c1">// library of your choice is available)</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">myArray</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span> <span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>




<p>Rather than going through the different answers one at a time, I&rsquo;m just going to tell you to visit this <a href="http://jsperf.com/rmurphey-foo-foo-foo/9">JSPerf test page</a> to see some of the variations, and their relative performance.</p>




<p>This brings up a good question <a href="http://twitter.com/ryanflorence/status/24505624622">tweeted by Ryan Florence</a>:</p>




<blockquote><p>T | F &ndash; In #JavaScript, 90% of the time we do stuff only a few times, maybe hundreds. Therefore, 90% of the time Readability > Performance.</p></blockquote>




<p>I tend to come down on the side of readability and compression over straight-up perf, precisely because we&rsquo;re rarely doing anything that&rsquo;s actually that intensive. On the other hand, we should avoid doing things that are outright stupid; where the line gets drawn depends a lot, I think, on experience.</p>




<p>Here&rsquo;s the thing, though: Something that seems like a gratuitous and obscure optimization to a less experienced developer might seem completely readable and obvious to a more experienced developer. How to balance this? Can comments bridge the gap? Should the gap be bridged? I dunno.</p>




<h2>Question 6: Basic jQuery Best Practices and DRY</h2>




<p>I see way too much code in real life that looks like this question.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 6: how could you improve the following code?</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.foo #bar&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.foo #bar&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;border&#39;</span><span class="p">,</span> <span class="s1">&#39;1px solid blue&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.foo #bar&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s1">&#39;new text!&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.foo #bar&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;new title&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">width</span><span class="p">(</span><span class="s1">&#39;100px&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.foo #bar&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>




<p>There are a slew of things wrong in this tiny snippet. First and foremost, making the same selection repeatedly suggests that the author fundamentally doesn&rsquo;t understand what their code is doing, or the expense they&rsquo;re incurring in doing it; the selection should be made once, and then the selection should be cached and/or the methods should be chained.</p>




<p>While it wasn&rsquo;t imperative, submitters did well to point out that CSS changes should be made via class names instead of hard-coded CSS in JavaScript; they also did well to put the click handler in a named function. Finally, while there may be cases where an ID selector needs to be prefixed by a class, i.e. <code>.foo #bar</code>, I appreciated it if people questioned this.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">handleClick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;new title&#39;</span><span class="p">)</span>
</span><span class='line'>          <span class="p">.</span><span class="nx">width</span><span class="p">(</span><span class="s1">&#39;100px&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">bar</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#bar&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="c1">// ideally: use a class for this</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">css</span><span class="p">({</span>
</span><span class='line'>          <span class="nx">color</span> <span class="o">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">border</span> <span class="o">:</span> <span class="s1">&#39;1px solid blue&#39;</span>
</span><span class='line'>        <span class="p">})</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s1">&#39;new text!&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">handleClick</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">));</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">handleClick</span><span class="p">(</span><span class="nx">bar</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>




<h2>Question 7: Asynchronicity</h2>




<p>This is a pretty newby thing, but I wanted to make sure people understood the basic concept of async requests &mdash; that is, you can&rsquo;t set the value of a variable inside an XHR&rsquo;s callback and expect that value to be available immediately.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">foo</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">dojo</span><span class="p">.</span><span class="nx">xhrGet</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">url</span> <span class="o">:</span> <span class="s1">&#39;foo.php&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">load</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">foo</span> <span class="o">=</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">foo</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">foo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// run this important code</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})();</span>
</span></code></pre></td></tr></table></div></figure>




<p>Fixing this just involves waiting for the XHR to complete before running the code that expects <code>foo</code> to be set. (Alternately, you could make the request run synchronously by setting <code>sync : true</code> in the XHR config object.)</p>




<p>There was one other issue with this code as well: Dojo needs to know the response should be handled as JSON, else it will handle it as text. If a submitter missed this, I didn&rsquo;t hold it against them &mdash; Pete Higgins actually had to point it out to me :) That said, it would become pretty obvious pretty quickly in real code.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">dojo</span><span class="p">.</span><span class="nx">xhrGet</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">url</span> <span class="o">:</span> <span class="s1">&#39;foo.php&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">handleAs</span> <span class="o">:</span> <span class="s1">&#39;json&#39;</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">addCallback</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">resp</span> <span class="o">&amp;&amp;</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">foo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// do stuff</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">})();</span>
</span></code></pre></td></tr></table></div></figure>




<p>Note that the callback function could also be specified in the XHR config object using the <code>load</code> property; Dojo&rsquo;s XHRs are great in that while you can specify everything in a config object, you can also attach callbacks to the return value of the XHR methods. You should <a href="http://docs.dojocampus.org/dojo/Deferred">read more about this</a> because it is very pleasant.</p>




<h2>Question 8: DRY</h2>




<p>Repetitive code is dumb.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 8: how could you rewrite the following code to make it shorter?</span>
</span><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">$</span><span class="p">){</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li.foo a&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;i am foo&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li.bar a&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;i am bar&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li.baz a&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;i am baz&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li.bop a&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;i am bop&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">})(</span><span class="nx">dojo</span><span class="p">,</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">query</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>




<p>How far you want to go with DRYing this out is debatable, but to me this cries out for improvement. Here&rsquo;s what I&rsquo;d do:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">$</span><span class="p">){</span>
</span><span class='line'>  <span class="nx">d</span><span class="p">.</span><span class="nx">forEach</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;bop&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li.&#39;</span> <span class="o">+</span> <span class="nx">c</span> <span class="o">+</span> <span class="s1">&#39; a&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;i am &#39;</span> <span class="o">+</span> <span class="nx">c</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">})(</span><span class="nx">dojo</span><span class="p">,</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">query</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>




<p>I&rsquo;d be lying if I didn&rsquo;t mention that I also wanted to show here how easy it is to make Dojo look like jQuery. After all, it&rsquo;s just JavaScript, right?</p>




<h2>Question 9: DOM Manipulation Best Practices &amp; DRY</h2>




<p>I thought it was well-known that we don&rsquo;t append 202 things to the DOM one at a time; the good news is, most people did know this. The bad news is, some people did not.</p>




<p>In addition to doing 202 appends, this code also does 202 selections. To top it off, the iterator <code>i</code> is global because we didn&rsquo;t prefix it with <code>var</code>.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 9: how would you improve the following code?</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#thinger&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span>
</span><span class='line'>    <span class="s1">&#39;&lt;p&gt;&lt;span class=&quot;thinger&quot;&gt;i am thinger &#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;&lt;/span&gt;&lt;/p&gt;&#39;</span>
</span><span class='line'>  <span class="p">);</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#gizmo&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span>
</span><span class='line'>    <span class="s1">&#39;&lt;p&gt;&lt;span class=&quot;gizmo&quot;&gt;i am gizmo &#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;&lt;/span&gt;&lt;/p&gt;&#39;</span>
</span><span class='line'>  <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>Here&rsquo;s a fix:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">thingerDom</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">gizmoDom</span> <span class="o">=</span> <span class="p">[],</span>
</span><span class='line'>    <span class="nx">tpl</span> <span class="o">=</span> <span class="s1">&#39;&lt;p&gt;&lt;span class=&quot;%s&quot;&gt;i am %s %i&lt;/span&gt;&lt;/p&gt;&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">tplFn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">tpl</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/%s/g</span><span class="p">,</span> <span class="nx">str</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/%i/g</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">i</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">thingerDom</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">tplFn</span><span class="p">(</span><span class="s1">&#39;thinger&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">));</span>
</span><span class='line'>  <span class="nx">gizmoDom</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">tplFn</span><span class="p">(</span><span class="s1">&#39;gizmo&#39;</span><span class="p">,</span> <span class="nx">i</span><span class="p">));</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#thinger&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">thingerDom</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#gizmo&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">gizmoDom</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>




<p>There&rsquo;s more that could be done here to DRY this out a bit more, but the fix addresses the main problem of excessive DOM manipulation.</p>




<h2>Question 10: Loose Typing</h2>




<p>Numbers in JavaScript suck, especially when the user enters them.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 10: a user enters their desired tip into a text box; the baseTotal,</span>
</span><span class='line'><span class="c1">// tax, and fee values are provided by the application. what are some</span>
</span><span class='line'><span class="c1">// potential issues with the following function for calculating the total?</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">calculateTotal</span><span class="p">(</span><span class="nx">baseTotal</span><span class="p">,</span> <span class="nx">tip</span><span class="p">,</span> <span class="nx">tax</span><span class="p">,</span> <span class="nx">fee</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">baseTotal</span> <span class="o">+</span> <span class="nx">tip</span> <span class="o">+</span> <span class="nx">tax</span> <span class="o">+</span> <span class="nx">fee</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>How you&rsquo;d actually deal with this problem would probably depend on the business logic of your application; you may be well-advised to convert everything to integers instead of trying to deal with decimals, because math with floats in JavaScript can have issues.</p>




<p>What I wanted to see in submissions, though, was an awareness that the tip would come to us as a string, and we couldn&rsquo;t just add it to the other arguments and expect a useful result. I was more interested in the discussion of this problem, and other problems that could arise, but here&rsquo;s at least the beginning of a solution:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">calculateTotal</span><span class="p">(</span><span class="nx">baseTotal</span><span class="p">,</span> <span class="nx">tip</span><span class="p">,</span> <span class="nx">tax</span><span class="p">,</span> <span class="nx">fee</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// convert the tip to a number using base 10;</span>
</span><span class='line'>  <span class="c1">// allow for a NaN result from parseFloat</span>
</span><span class='line'>  <span class="nx">tip</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">tip</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// don&#39;t allow a negative tip</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">tip</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="nx">tip</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">baseTotal</span> <span class="o">+</span> <span class="nx">tip</span> <span class="o">+</span> <span class="nx">tax</span> <span class="o">+</span> <span class="nx">fee</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<h2>Question 11: Array Mapping</h2>




<p>For this question, I was looking for code that used a <code>map</code> method to return an array by running a function on each item in the array. Some people used a <code>forEach</code> method to iterate over the array instead, and then push the results to a new array they created. I guess this is OK, but it&rsquo;s not my preference.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 11: given the following data, write code that returns an array</span>
</span><span class='line'><span class="c1">// containing the name of each item, followed by a comma-separated list of</span>
</span><span class='line'><span class="c1">// the item&#39;s extras, if it has any. e.g.</span>
</span><span class='line'><span class="c1">//</span>
</span><span class='line'><span class="c1">//    [ &quot;Salad (Chicken, Steak, Shrimp)&quot;, ... ]</span>
</span><span class='line'><span class="c1">//</span>
</span><span class='line'><span class="c1">// (you can assume the library of your choice is available)</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">menuItems</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="nx">id</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">name</span> <span class="o">:</span> <span class="s1">&#39;Salad&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">extras</span> <span class="o">:</span> <span class="p">[</span>
</span><span class='line'>      <span class="s1">&#39;Chicken&#39;</span><span class="p">,</span> <span class="s1">&#39;Steak&#39;</span><span class="p">,</span> <span class="s1">&#39;Shrimp&#39;</span>
</span><span class='line'>    <span class="p">]</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="nx">id</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">name</span> <span class="o">:</span> <span class="s1">&#39;Potato&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">extras</span> <span class="o">:</span> <span class="p">[</span>
</span><span class='line'>      <span class="s1">&#39;Bacon&#39;</span><span class="p">,</span> <span class="s1">&#39;Sour Cream&#39;</span><span class="p">,</span> <span class="s1">&#39;Shrimp&#39;</span>
</span><span class='line'>    <span class="p">]</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="nx">id</span> <span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">name</span> <span class="o">:</span> <span class="s1">&#39;Sandwich&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">extras</span> <span class="o">:</span> <span class="p">[</span>
</span><span class='line'>      <span class="s1">&#39;Turkey&#39;</span><span class="p">,</span> <span class="s1">&#39;Bacon&#39;</span>
</span><span class='line'>    <span class="p">]</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="nx">id</span> <span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">name</span> <span class="o">:</span> <span class="s1">&#39;Bread&#39;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>




<p>Here&rsquo;s an answer:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">newArray</span> <span class="o">=</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">menuItems</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">extras</span> <span class="o">&amp;&amp;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">extras</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">ret</span> <span class="o">+=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">extras</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>




<h2>Bonus 1: Functional Programming 101</h2>




<p>This was a late addition, courtesy of <a href="http://andrew.hedges.name/">Andrew Hedges</a>, so not everyone saw it:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// BONUS: write code such that the following alerts &quot;Hello World&quot;</span>
</span><span class='line'><span class="nx">say</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)(</span><span class="s1">&#39;World&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>




<p>I wanted to see people understand that functions could return other functions, and that the returned function has access to the scope of the wrapper function:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">say</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">first</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">second</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">alert</span><span class="p">(</span><span class="nx">first</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">second</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<p>Some people got pleasantly carried away with this question; check out this <a href="http://jsfiddle.net/t8cAK/">JSFiddle</a> from Colin Snover.</p>




<h2>Bonus 2: Attention to Detail</h2>




<p>This last bonus was riddled with errors, including some that I made accidentally when I wrote it at 2 a.m.</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// BONUS: what is the faulty logic in the following code?</span>
</span><span class='line'><span class="c1">// how would you fix it?</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
</span><span class='line'>    <span class="nx">day</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">(),</span>
</span><span class='line'>    <span class="nx">month</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span>
</span><span class='line'>    <span class="nx">dates</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">dates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">month</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">day</span> <span class="o">+</span> <span class="nx">i</span><span class="p">));</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The next five days are &#39;</span><span class="p">,</span> <span class="nx">dates</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>




<p>Here&rsquo;s what you should see:</p>




<ul>
<li>The <code>for</code> loop will return 6 dates, not 5.</li>
<li>The method for calculating the date for each successive date could end up with nonexistent dates (32, 33, etc.), and it doesn&rsquo;t change the month when it should.</li>
<li>The <code>getMonth</code> method on the date object returns a zero-indexed month.</li>
</ul>




<p>Here&rsquo;s a fix:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
</span><span class='line'>      <span class="nx">otherDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
</span><span class='line'>      <span class="nx">day</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nx">getDate</span><span class="p">(),</span>
</span><span class='line'>      <span class="nx">future</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">dates</span> <span class="o">=</span> <span class="p">[],</span>
</span><span class='line'>      <span class="nx">i</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">future</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">otherDate</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">day</span> <span class="o">+</span> <span class="nx">i</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">newMonth</span> <span class="o">=</span> <span class="nx">otherDate</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">newDay</span> <span class="o">=</span> <span class="nx">otherDate</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
</span><span class='line'>    <span class="nx">dates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">newMonth</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">newDay</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})();</span>
</span></code></pre></td></tr></table></div></figure>




<h2>Postscript</h2>




<p>I want to be really clear that I&rsquo;m not some super-awesome and infallible JavaScript developer, and more to the point, there was a time in the not-too-distant past where I would have failed my own quiz miserably. While my main goal in putting this together was to find some skilled developers to help me out, I also wanted to provide a tool for exposing up-and-coming developers to some slightly more advanced concepts of JavaScript. I hope that, whatever your skill level, you found it to be at least entertaining, and at best, useful. I also hope you&rsquo;ll forgive any gross errors I&rsquo;ve made in the answers above, though I tried <em>really</em> hard to test them all.</p>




<h2>Post-Postscript</h2>




<ul>
<li>To the person who complained that I included code from a library other than jQuery, and who helpfully illustrated their point with the graph that shows jQuery is obviously better than anything that ever was: I&rsquo;m not sure whether to laugh or cry or just be really snarky. I&rsquo;m looking for JavaScript developers. If you don&rsquo;t see the value in knowing more than just jQuery, and if you can&rsquo;t find your way through relatively trivial non-jQuery code, you need not apply.</li>
<li>If you found the questions vague and requiring a lot of assumptions or guesswork, well, welcome to consulting &mdash; if such things make you uncomfortable, we&rsquo;re not going to be a good fit. I was looking for people to tell me what they know, to impress me, to point out where they saw holes in the questions, to take initiative. This was not a multiple choice test; it was an interview.</li>
</ul>




<h2>License</h2>




<p>If you think the quiz would be useful to you as you&rsquo;re looking for a JavaScript developer to call your own, it&rsquo;s licensed under the <a href="http://sam.zoy.org/wtfpl/">WTFPL</a>, which you should read just because it&rsquo;s funny.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Making sense of dojo.when: A simple XHR caching example]]></title>
    <link href="http://rmurphey.com/blog/2010/08/29/making-sense-of-dojo-when-a-simple-xhr-caching-example/"/>
    <updated>2010-08-29T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2010/08/29/making-sense-of-dojo-when-a-simple-xhr-caching-example</id>
    <content type="html"><![CDATA[<p>Right before Dojo 1.5 came out, the Sitepen blog had <a href="http://www.sitepen.com/blog/2010/05/03/robust-promises-with-dojo-deferred-1-5/">a great post</a> about the improvements 1.5 would bring for <code>dojo.Deferred</code>. The part that really caught my eye was <a href="http://docs.dojocampus.org/dojo/when"><code>dojo.when</code></a>, a method that lets you pass a value to a function whether that value is available now or as the result of some asynchronous operation. Either way, you get a &ldquo;promise&rdquo; that <em>when</em> the value is available, the function you provided will run.</p>




<p>This is one of those things that was super-neat when I read about it, but it took me a while to incorporate it into my code &mdash; it&rsquo;s only in the last couple of weeks that I&rsquo;ve had that wonderful moment when I&rsquo;ve said &ldquo;oh, I could totally use <code>dojo.when</code> for that!&rdquo; Moments like these make me very happy.</p>




<p>It&rsquo;s pretty common that an application makes an Ajax request for some data, and then caches that data so the request won&rsquo;t have to happen again; the pattern might look something like this:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">myCache</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">getSomeStuff</span><span class="p">(</span><span class="nx">stuffId</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">myCache</span><span class="p">[</span><span class="nx">stuffId</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">handleResponse</span><span class="p">(</span><span class="nx">myCache</span><span class="p">[</span><span class="nx">stuffId</span><span class="p">]);</span>
</span><span class='line'>    <span class="k">return</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">dojo</span><span class="p">.</span><span class="nx">xhrGet</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">url</span> <span class="o">:</span> <span class="s1">&#39;foo.php&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">content</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="o">:</span> <span class="nx">stuffId</span> <span class="p">},</span>
</span><span class='line'>    <span class="nx">load</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">myCache</span><span class="p">[</span><span class="nx">stuffId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">handleResponse</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>Here we have a function that takes an ID; the function looks in the cache to see if there&rsquo;s a value stored for the ID, and if so, it passes the stored value to a <code>handleResponse</code> function. If not, it does an XHR to get the data; when the XHR succeeds, it stores the data in the cache and, again, passes the value to the <code>handleResponse</code> function.</p>




<p>There&rsquo;s nothing strictly wrong with this, but I discovered that some neat abstraction opportunities became more clear when I switched to using <code>dojo.when</code> instead:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">myCache</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">getSomeStuff</span><span class="p">(</span><span class="nx">stuffId</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">dojo</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span>
</span><span class='line'>    <span class="nx">myCache</span><span class="p">[</span><span class="nx">stuffId</span><span class="p">]</span> <span class="o">||</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">xhrGet</span><span class="p">({</span>
</span><span class='line'>      <span class="nx">url</span> <span class="o">:</span> <span class="s1">&#39;foo.php&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">content</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="o">:</span> <span class="nx">stuffId</span> <span class="p">},</span>
</span><span class='line'>      <span class="nx">load</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">myCache</span><span class="p">[</span><span class="nx">stuffId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}),</span>
</span><span class='line'>    <span class="nx">handleResponse</span>
</span><span class='line'>  <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>Now we&rsquo;re telling our <code>getSomeStuff</code> function to look for a cached value; if it finds one, <code>dojo.when</code> will immediately pass that value to the <code>handleResponse</code> function. If it doesn&rsquo;t find one, it will run the XHR, and <code>dojo.when</code> will magically pass the XHR&rsquo;s response to the <code>handleResponse</code> function instead. This is hot.</p>




<p>This works because <code>dojo.xhrGet</code> returns a &ldquo;promise&rdquo; object with a <code>then</code> method. <code>dojo.when</code> looks to see whether it got a promise object as its first argument; if so, it uses the <code>then</code> method of the promise object to attach the callback provided as the second argument to <code>dojo.when</code>. If not, it simply calls the callback immediately on the first argument. The real magic is actually in <code>dojo.Deferred</code>, not in <code>dojo.when</code> itself. Since all of Dojo&rsquo;s XHR methods return a <code>dojo.Deferred</code> promise, <code>dojo.when</code> will &ldquo;just work.&rdquo;</p>




<p>I found that I was going through my application and ripping out instances of the old code, replacing it with the new. And then I had that &ldquo;oh sh*t I&rsquo;m copying and pasting, aren&rsquo;t I &hellip;&rdquo; moment, and saw my way to an abstraction.</p>




<p>In my application, I was actually caching the responses using the URL from which I&rsquo;d requested them, which works out to be a perfectly unique ID for the data. (This particular part may or may not work in your application.) My abstraction was an essentially drop-in replacement for <code>dojo.xhrGet</code> calls:</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">cache</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">cacheableXhrGet</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">req</span> <span class="o">=</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">url</span><span class="p">]</span> <span class="o">||</span>
</span><span class='line'>            <span class="nx">dojo</span><span class="p">.</span><span class="nx">xhrGet</span><span class="p">(</span><span class="nx">dojo</span><span class="p">.</span><span class="nx">mixin</span><span class="p">({</span>
</span><span class='line'>              <span class="c1">// override the load handler</span>
</span><span class='line'>              <span class="nx">load</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">cache</span><span class="p">[</span><span class="nx">url</span><span class="p">]</span> <span class="o">=</span> <span class="nx">resp</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>            <span class="p">},</span> <span class="nx">settings</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">dojo</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">load</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">req</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>I can pass a settings object to <code>cacheableXhrGet</code> that looks exactly like the object I&rsquo;d pass to <code>dojo.xhrGet</code>, but replace the <code>load</code> function before actually passing it to <code>dojo.xhrGet</code>. But before the XHR even has a chance to get set up, I check my cache for a stored response; if I find one, I store it in the <code>req</code> variable, but otherwise I store the XHR there.</p>




<p>In either case, the function defined at <code>settings.load</code> gets the proper response value via <code>dojo.when</code>. For bonus points, I then return either the cached value or the XHR &mdash; which means <em>other code can use the return value of <code>cacheableXhrGet</code> for its own <code>dojo.when</code></em>. How neat is that?</p>




<h2>Conclusion</h2>




<p>Promises and deferred&rsquo;s are a really pleasant tool to have in your JavaScript arsenal once you get the hang of them, and <code>dojo.when</code> seems like a great place to start understanding them.</p>




<p>Out of the box, Dojo makes use of deferreds for all of its XHR functionality, meaning that you can pass around the return value of any Dojo XHR method and do fun things you can&rsquo;t do with jQuery&rsquo;s <code>$.ajax</code>, like add more callbacks to a request after you&rsquo;ve set it up.</p>




<p>I&rsquo;ve just recently started realizing when I could incorporate <a href="http://docs.dojocampus.org/dojo/Deferred"><code>dojo.Deferred</code></a> functionality into my own code &mdash; again, now that I&rsquo;ve got the hang of it, I&rsquo;m pretty sure it&rsquo;s going to dramatically change how I write asynchronous code.</p>




<p><em>Disclaimer: This post contains sample code for illustration purposes. In reality it&rsquo;s all namespaced and these naked functions are actually methods in classes and stuff, and the real code doesn&rsquo;t even look much like the code you see here. I&rsquo;ve also completely ignored questions of when to clear or invalidate the cache. You&rsquo;ve been warned.</em></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Code Org, Take 2: Structuring JavaScript Applications]]></title>
    <link href="http://rmurphey.com/blog/2010/08/27/code-org-take-2-structuring-javascript-applications/"/>
    <updated>2010-08-27T00:00:00-04:00</updated>
    <id>http://rmurphey.com/blog/2010/08/27/code-org-take-2-structuring-javascript-applications</id>
    <content type="html"><![CDATA[<p>It&rsquo;s hard to believe it was not even a year ago that I spoke at the jQuery Conference in Boston about code organization. At the time, I&rsquo;d been thinking for a few months about how to improve my own code and give it more structure, and how to give advice to others about how to do the same.</p>




<p>My talk was about code organization, but really I was talking about how you might organize a single piece of functionality; I didn&rsquo;t even begin to answer the larger question of how to structure a bona fide JavaScript application. Really, that question is almost perpendicular to the one I was tackling at the time; it&rsquo;s a question of strategy, not tactics.</p>




<p>A year later, I&rsquo;d like to share my thoughts on how I&rsquo;m answering it these days.</p>




<h2>First Things First: What&rsquo;s a JavaScript Application?</h2>




<p>GMail is a JavaScript application; this Posterous blog, while it makes use of JavaScript a bit, is probably not, but the admin interface most certainly is. The line can be frustratingly fuzzy, but at the same time it&rsquo;s pretty important to realize when you&rsquo;ve crossed it.</p>




<p><strong>To me, the defining characteristic of a JavaScript application is that the heavy lifting of manipulating and displaying data falls to the browser</strong>, with most communication with the server happening via XHR.</p>




<p>If you find yourself in application land, welcome. Now what?</p>




<h2>My Building Blocks</h2>




<p>My approach to organizing an application is really just an MVC variant, so I don&rsquo;t want to sound as though I&rsquo;ve discovered something novel or new. However, there are a couple of things to note: For one, the term &ldquo;controller&rdquo; has a couple of different meanings to me, as explained below; for two, there are two distinct flavors of &ldquo;views,&rdquo; though I&rsquo;m not sure exactly how important the distinction is.</p>




<p>I also want to be super-clear that I don&rsquo;t tout this as The One and Only Way; it is just a way that has worked for me, a way that I evolve and adapt with every project I work on, and a way that I&rsquo;ve run by a few people and they haven&rsquo;t laughed at me. My point in dissecting it isn&rsquo;t that you&rsquo;ll try to follow it word-for-word; rather, I hope it might get you thinking about  JavaScript applications beyond the DOM.</p>




<h3>Models</h3>




<p>There&rsquo;s nothing particularly unique to models in a JavaScript application. They are responsible for fetching and storing application data and maintaining its integrity in the browser. They fetch data, store data, and provide an API for other application components to get access to that data. There may be more than one destination for the data: memory, the server, or some type of local storage. But if it has to do with managing data, it&rsquo;s the model&rsquo;s job.</p>




<p>Models stay out of the way when it comes to displaying data or responding (at least directly) to user interaction. Those tasks are left up to other pieces of the application, as we&rsquo;ll see below.</p>




<h4>Example</h4>




<p>A simple search application would likely have a search results model, responsible for receiving the current search term, fetching the data for the term, and broadcasting it to the rest of the application. It might also allow for manipulating individual search results, such as indicating that a particular result was a favorite or a dud, though that task might also fall to an individual search result model depending on the needs.</p>




<h3>Widgets and Data Views</h3>




<p>Views comprise HTML (generally in the form of client-side templates) and CSS for a component, and are generally accompanied by a view controller (the  JavaScript related to interacting with the vew; see below for an explanation). The HTML for a view consists of a single parent node with an arbitrary internal structure; the parent node will optionally have one or more classes on it that can be used to target CSS.</p>




<p>There are two flavors of views, in my mind: widgets, which are responsible for supporting user interaction with the application but don&rsquo;t render any application data; and data views that are responsible for displaying and allowing interaction with application data.</p>




<p>Data views are instantiated with the initial data required to populate them; then, their view controllers listen for messages from other pieces of the application to tell them when new or updated data needs to be rendered.</p>




<h4>Examples</h4>




<p>A basic search input box would be considered a widget &mdash; when it is created, it doesn&rsquo;t need any application data in order to render properly. The widget is strictly responsible for allowing the basic interaction of typing a search term and hitting enter; that is, it&rsquo;s not responsible for actually performing the search.</p>




<p>A search results list is an example of a data view; it renders application data <em>and</em>, potentially, allows for interaction with it. Again, though, it&rsquo;s not responsible for performing the search; it just renders data and then allows for interaction with it.</p>




<h3>View Controllers</h3>




<p>View controllers manage interaction with a data view or widget &mdash; interaction by the user, and interaction with the rest of the application. They are responsible for binding and handling events, for broadcasting user interactions with the widget to the rest of the application, and for listening to other pieces of the application to tell them they have new data to render.</p>




<p>View controllers <em>never</em> handle server communication directly; their role is solely to provide a user interface to the application. When something interesting happens to a view or widget, the view controller announces it. When new data is available for a view, the view controller should know how to handle it. But, again, the view controller itself should focus on providing a user interface, not on interfacing with the server.</p>




<h4>Examples</h4>




<p>The view controller for a search box might listen for the user to focus on the search box, hiding placeholder text for the input. Then, it might listen for the user to hit Enter inside the search box; when that happens, it would broadcast to the rest of the application that the user had submitted a search, along with the term that was searched.</p>




<p>The view controller for a search results list might listen for another piece of the application to announce that new search results are available to be displayed. If the results were for the currently displayed search term, it could add them to the list; if they were for a new term, the results list could empty itself and display the new results.</p>




<h3>Application-Level Controllers</h3>




<p>Application-level controllers are the glue of an application. Loosely, there may be one per &ldquo;page&rdquo; of the application, or one per feature. For example, an application that includes a search feature and a checkout feature might have a controller for each feature, even though the checkout feature might spread across multiple pages.</p>




<p>These controllers are responsible for getting the models and views/widgets for a feature in place and talking to each other. So, a controller might first make sure the required models are in place, then tell them to fetch the appropriate data; once the data is available, the controller would instantiate the views for displaying the data. Finally, the controller would broker future interactions between the views and the models.</p>




<h4>Examples</h4>




<p>On a search results page, a user might click a Favorite button on a search result. The search results list&rsquo;s view controller would handle the click, broadcasting a message about the user&rsquo;s action to the rest of the application. The controller would observe this message and pass it, along with any other relevant information, to the search results model, which would in turn pass the information to the server, or store it locally.</p>




<h2>Notes on Enablers</h2>




<p>I&rsquo;ve glossed over a few implementation details that are somewhat tangential to the organization question, but I want to touch on them briefly:</p>




<h3>Pubsub and Friends</h3>




<p>I didn&rsquo;t want to get too specific about how all of this &ldquo;announcing&rdquo; and &ldquo;broadcasting&rdquo; and &ldquo;listening&rdquo; happens, because there are lots of ways to accomplish it. One could use pubsub, custom events, or any number of other solutions. I don&rsquo;t think the actual implementation is important, though personally I lean heavily on pubsub &mdash; what is important is the notion of broadcasting and listening for announcements that something has happened, allowing other components of the application to react appropriately.</p>




<h3>Templating</h3>




<p>If you aren&rsquo;t using a toolkit with templating built in (or, heck, even if you are), I&rsquo;ve kind of fallen in love with <a href="http://github.com/janl/mustache.js/">mustache.js</a> lately. It&rsquo;s a great client-side templating companion, making it dead-simple to turn data into markup without ending up with templates that look more like JavaScript than HTML.</p>




<p>Figuring out how to maintain templates can be tricky &mdash; do you store them in your page&rsquo;s markup? Do you maintain them as separate files requested via XHR and then cached? Or do you put them in your JavaScript? Dojo&rsquo;s <code>dojo.cache()</code> method provides a handy way to keep your templates in separate files and load them via XHR, while interning them into your JavaScript for you if you use Dojo&rsquo;s build tool. I like this.</p>




<h3>Attaching Events to Views</h3>




<p>Another shameless Dojo plug: <code>dijit.\_Templated</code> provides some serious hotness when it comes to attaching events to views. Read up on <a href="http://docs.dojocampus.org/dijit/_Templated"><code>dojoAttachPoint</code> and <code>dojoAttachEvent</code></a>; together with dijit._Widget&rsquo;s <code>connect</code> and <code>subscribe</code> methods, which provide automatic cleanup for you, there&rsquo;s some real power here, which has me writing hardly any selector-based code these days.</p>




<h3>File Structure</h3>




<p>I hesitate to make any particular recommendations here, because the needs of an application can vary widely. However, I tend to have a directory each for models, views (for view controllers and templates), and controllers (for application-level controllers). Those directories &mdash; especially the views directory &mdash; may contain subdirectories, for instance if there&rsquo;s more than one view for a certain type of data.</p>




<h2>Why Go To All This Trouble, Again?</h2>




<p>So this is the part where you might say &ldquo;OMG, srsly, what happened to &lsquo;get some elements, do something with them?!?&rsquo;&rdquo; Let me be clear, that approach may be <em>entirely appropriate</em> for your particular needs; I&rsquo;m not here to convince you otherwise.</p>




<p>But: if your application is complex enough to warrant considering an approach like this, I&rsquo;ve found that in the long run it actually simplifies my code by cleanly separating concerns and providing a decent roadmap for building new features. I can build and test a solid model for some Thinger, and then use that model throughout my code; I can build and test a user interface component for editing a Thinger long before the data exists to support it. I can map &ldquo;pages&rdquo; of my application to application-level controllers, providing a high-level view of what&rsquo;s happening where.</p>




<p>Best of all, paths to code reuse become clear and entanglements become fewer when I keep this division of responsibilities in mind as I code. A search results data view, for example, can be made to accept search results from any model that provides them in the proper format; a search can be initiated and the results displayed without depending on a user entering text into a search input widget.</p>




<p>Dividing the responsibilities into well-defined sections leads to components that are truly pluggable, often in ways you may not have even imagined when you wrote them. In an application that evolves over time, it&rsquo;s hard to overstate the benefits of this.</p>




<h2>In Conclusion &amp; A Plea</h2>




<p>If you find yourself working on a JavaScript application, I can&rsquo;t recommend enough that you consider, at length, what underlying structure makes the most sense; it&rsquo;s almost inevitably more complex than you can manage via the DOM alone. Again, my answer isn&rsquo;t the right answer, it&rsquo;s just an answer, but I hope it helps you start thinking about what the right answer might be for your project.</p>




<p>If you&rsquo;re interested in this stuff, I&rsquo;d encourage you to check out <a href="http://javascriptmvc.com/">JavaScriptMVC</a>, if only to see how they approach these problems; <a href="http://cujojs.com/">Cujo.js</a> is another framework, built on top of Dojo, that aims to enter this space, but you&rsquo;ll have to wait until mid-September to see it.</p>




<p>Finally: If you have your own thoughts to share about how to approach these large application questions, I&rsquo;m pleading with you to write your own blog post(s) about them. If you have other reference material on the topic, I beg you to share it. As more and more people transition from simple JavaScript enhancements to non-trivial applications, the need for education is huge.</p>

]]></content>
  </entry>
  
</feed>
